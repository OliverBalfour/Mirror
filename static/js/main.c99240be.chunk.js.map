{"version":3,"sources":["common/utils.js","components/popovermenu.js","components/tabview.js","components/button.js","ducks/kanban.js","store.js","components/markdown.js","components/autocomplete-editor.js","kanban/attributes/description.js","kanban/attributes/datetime.js","kanban/attributes/ebs.js","kanban/attributes/index.js","components/dialogs.js","components/menubar.js","components/undoredo.js","kanban/boardview.js","kanban/index.js","zettelkasten/index.js","app.js","serviceWorker.js","index.js"],"names":["__lastGeneratedID","generateID","format","newID","fn","Date","substring","length","parseInt","dummyState","epochms","getTime","ids","initial","tabs","name","id","created","edited","colnums","colnames","numcards","reduce","a","b","cards","sampleCards","i","type","content","Math","floor","random","moved","columns","cnt","items","Object","keys","slice","dummyCols","colIDs","tabOrder","description","modifyVersion","oldSemver","newSemver","mutation","localStorage","version","state","JSON","parse","kanban","stringify","objectMap","object","mapFn","result","key","prettyPrintDate","epochMilliseconds","date","now","time","getHours","getMinutes","diff","weekDiff","weekStartsOn","yearDiff","day","getDate","currentLoc","window","location","hash","replace","useHashLocation","React","loc","setLoc","handler","addEventListener","removeEventListener","to","history","replaceState","undefined","linkName","card","firstLine","split","mergeRefs","refs","filteredRefs","filter","Boolean","inst","ref","current","ReloadProtect","shouldProtect","onbeforeunload","e","map","children","anchorEl","setAnchorEl","handleClose","Menu","keepMounted","open","onClose","entries","func","MenuItem","onClick","currentTarget","TabPanel","show","hidden","style","height","render","index","setIndex","addTab","renameTab","deleteTab","moveTab","handleChange","event","newValue","flex","AppBar","position","backgroundColor","zIndex","Tabs","value","onChange","indicatorColor","textColor","tab","Tab","label","flexGrow","IconButton","makeStyles","theme","button","transferCard","createAction","reorderCard","addCard","editCardContent","editCard","deleteCard","addColumn","deleteColumn","renameColumn","moveColumn","archiveCardsInColumn","addZettel","editZettel","deleteZettel","toggleZettelStarred","deleteInList","list","elem","indexOf","splice","selectors","getColumnsInTabs","colID","col","archivedCards","values","activeCards","starredZettels","cardsByTab","flatMap","initialState","Error","cardID","numCols","hasOwnProperty","loadState","reducer","createReducer","s","payload","srcColID","dstColID","srcIndex","dstIndex","srcCol","dstCol","removed","newitems","unshift","tabIdx","forEach","tabID","push","shift","srcIdx","dstIdx","archived","archivedFromColID","zettel","undoable","limit","store","configureStore","boards","middleware","getDefault","concat","thunk","document","activeElement","tagName","toLowerCase","ctrlKey","which","shiftKey","dispatch","UndoActionCreators","undo","redo","globalSelectors","present","boardSelectors","localSelector","localStorageSubscriber","serialised","setItem","saveState","getState","subscribe","props","source","m","prefix","regex","exec","lastIndex","parseable","match","before","link","after","parseWikilinks","escapeHtml","setValue","autoFocus","addNote","rowsMax","inputRef","useSelector","editor","TextareaEditor","strategy","context","beforeCursor","search","term","callback","matches","tl","includes","searchCards","cache","template","setTimeout","textcomplete","Textcomplete","dropdown","rotate","maxCount","destroy","TextField","margin","fullWidth","variant","multiline","rows","target","inputProps","Edit","setCard","editingDescription","setEditingDescription","InputLabel","className","ClickAwayListener","onClickAway","width","marginTop","Indicator","title","join","icon","enAU","weekStart","setDateTime","utils","DateFnsUtils","locale","DateTimePicker","newDate","showTodayButton","Button","color","float","startOfToday","setEBS","ebsFields","ebs","prettySeconds","estimate","estStr","setEstStr","elapsed","elapStr","setElapStr","historical","sel","setEBSEstimate","str","unprettySeconds","computed","computeEstimate","invalid","marginRight","error","helperText","setEBSElapsed","FormControlLabel","control","Checkbox","checked","exact","size","ratio","acc","seconds","abs","round","hours","minutes","groups","x","pf","k","parseFloat","useStyles","padding","header","marginBottom","IndicatorBuilder","Chip","classes","borderRadius","background","AttributeHeader","ConfirmDialog","respond","subtitle","labels","Dialog","DialogTitle","DialogContent","DialogContentText","DialogActions","PromptDialog","inputType","placeholder","buttons","done","CardEditDialog","useDispatch","currentColID","setColID","newCard","setContent","maxWidth","disableBackdropClick","Select","labelId","ListSubheader","duck","AboutDialog","href","active","setActive","useState","aboutOpen","setAboutOpen","Fragment","top","bottom","Toolbar","minHeight","edge","console","log","val","TabIndicatorProps","verticalAlign","prompt","clear","filename","createElement","blob","Blob","URL","createObjectURL","download","click","downloadData","ActionCreators","root","display","flexDirection","flexWrap","fontSize","flexShrink","column","paddingBottom","border","transition","overflow","addColumnContainer","cardWidth","justifyContent","alignItems","columnHeaderContainer","columnHeaderText","paddingLeft","fontWeight","columnHeaderRule","marginLeft","userSelect","boxShadow","draggingCard","opacity","columnContainer","draggingColumn","tabInfo","tabObj","styles","promptOpen","setPromptOpen","editingCard","setEditingCard","tabIDfromCardID","overflowX","onDragEnd","res","destination","droppableId","direction","provided","snapshot","innerRef","add","hide","isDraggingOver","draggingFromThisWith","Column","editingNew","setEditingNew","editingValue","setEditingValue","addButton","scrollContainerRef","scrollTop","menuButton","internals","ignoreContainerClipping","overflowY","cancel","draggableId","draggableProps","isDragging","dragHandleProps","menu","EditingCard","ButtonGroup","ColumnHeader","confirmOpen","setConfirmOpen","Card","AddColumn","currentTab","setCurrentTab","num","addPromptOpen","setAddPromptOpen","renamePromptOpen","setRenamePromptOpen","alert","data","max","container","left","right","paddingTop","zettelTitle","textAlign","editingButtons","setLocNoHist","starred","currentCardID","setNewCard","part","editing","setEditing","yes","starZettel","screenNames","getScreen","n","getScreenName","hostname","ReactDOM","getElementById","navigator","serviceWorker","ready","then","registration","unregister","catch","message"],"mappings":"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","file":"static/js/main.c99240be.chunk.js","sourcesContent":["\nimport * as fn from 'date-fns';\nimport * as React from 'react';\n\nlet __lastGeneratedID = null;\nexport const generateID = () => {\n  const format = \"yyyyMMdd-hhmmss\";\n  let newID = fn.format(new Date(), format);\n  // if we generate multiple IDs in one second, we add \"-n\" where n is 1,2,...\n  // the only time this causes collisions is if you add a card, refresh, add a card within 1s\n  if (__lastGeneratedID !== null && __lastGeneratedID.substring(0, format.length) === newID) {\n    if (__lastGeneratedID.length === format.length) newID += \"-1\";\n    else newID += '-' + (parseInt(__lastGeneratedID.substring(format.length + 1, __lastGeneratedID.length)) + 1)\n  }\n  __lastGeneratedID = newID;\n  return newID;\n}\n\n// generate { cards, columns } where each column has colnum[i] cards\n// both of these are objects where the keys are unique IDs\n// cards are { id, content } structs\n// todo: make them arrays containing their IDs and write selectors instead\n// columns are { id, items: [ id ] } structs\n// Example: {\n//   cards: [{ id: \"a\", content: \"Item 1\" }],\n//   columns: [{ id: \"b\", items: [\"a\"] }],\n//   tabs: [{ name: \"Main\", columns: [\"b\"] }]\n// }\nexport const dummyCols = (colnums, colnames) => {\n  let numcards = colnums.reduce((a, b) => a + b, 0);\n  let cards = {};\n  let sampleCards = [\n    \"Wash the dishes\",\n    \"Make cool app\",\n    \"Run out of ideas for sample tasks for the app you're making\",\n    \"Cook pizza for dinner\",\n    \"Finish your chemistry homework\",\n    \"Write a tutorial explaining how monads are isomorphic to burritos in the category of food\",\n    \"Forget to wrap a line at 300 characters\",\n    \"Learn Common Lisp\",\n    \"Do normal human things\",\n    \"Prove P=NP for N=1\",\n    \"Eat some chocolate\",\n    \"Stop eating so much chocolate\",\n    \"Write witty comment\",\n    \"ðŸ™‚\"];\n  const epochms = new Date().getTime();\n  for (let i = 0; i < numcards; i++) {\n    let id = generateID();\n    cards[id] = { id, type: 0, content: sampleCards[Math.floor(Math.random()*sampleCards.length)],\n      created: epochms, edited: epochms, moved: epochms };\n  }\n  let columns = {};\n  for (let i = 0, cnt = 0; i < colnums.length; i++) {\n    let items = Object.keys(cards).slice(cnt, cnt + colnums[i]);\n    let id = generateID();\n    columns[id] = { id, items, name: colnames[i], created: epochms, edited: epochms };\n    cnt += colnums[i];\n  }\n  return { cards, columns };\n};\n\n// generate initial dummy state\nexport const dummyState = () => {\n  const epochms = new Date().getTime();\n  const ids = [generateID(), generateID()];\n  let initial = {\n    tabs: {\n      [ids[0]]: { name: \"Main\",      id: ids[0], created: epochms, edited: epochms },\n      [ids[1]]: { name: \"Secondary\", id: ids[1], created: epochms, edited: epochms }\n    },\n    ...dummyCols([9,2,6,5,4], [\"To Do\",\"Doing\",\"Done\",\"Misc 1\",\"Misc 2\"])\n  };\n  const colIDs = Object.keys(initial.columns);\n  initial.tabs[ids[0]].columns = [colIDs[0], colIDs[1], colIDs[2]];\n  initial.tabs[ids[1]].columns = [colIDs[3], colIDs[4]];\n  initial.tabOrder = ids;\n  initial.cards['main'] = { id:'main', content: 'Welcome', type: 1, description: 'Welcome to your Zettelkasten! You can edit this and use `[[wikilink]]` syntax to link to other nodes.',\n    created: epochms, edited: epochms }\n  return initial;\n}\n\nconst modifyVersion = (oldSemver, newSemver, mutation) => {\n  if (localStorage.version === oldSemver) {\n    let state = JSON.parse(localStorage.kanban);\n    mutation(state);\n    localStorage.kanban = JSON.stringify(state);\n    localStorage.version = newSemver;\n  }\n};\n\n// load persisted state\nconst currentVersion = \"0.2.1\"; // IMPORTANT\nexport const loadState = () => {\n  try {\n\n    // web\n    if (!localStorage.version) throw new Error();\n\n    // avert breaking changes\n    modifyVersion(\"0.1.0\", \"0.2.0\", state => {\n      const epochms = new Date().getTime();\n      state.cards['main'] = { id:'main', content: 'Welcome', description: 'Welcome to your Zettelkasten! You can edit this and use `[[wikilink]]` syntax to link to other nodes.',\n      created: epochms, edited: epochms }\n      return state;\n    });\n    modifyVersion(\"0.2.0\", \"0.2.1\", state => {\n      for (const cardID in state.cards) {\n        const numCols = Object.values(state.columns).filter(col => col.items.indexOf(cardID) !== -1).length;\n        state.cards[cardID].type = numCols ? 0 : 1;\n      }\n      state.cards['main'].type = 1;\n      return state;\n    });\n\n    if (localStorage.hasOwnProperty('kanban'))\n      return JSON.parse(localStorage.kanban) || dummyState();\n\n  } catch (e) {}\n  return dummyState();\n}\n\nexport const saveState = state => {\n  try {\n    if (localStorage) {\n      const serialised = JSON.stringify(state);\n      localStorage.setItem(\"kanban\", serialised);\n      localStorage.setItem(\"version\", currentVersion);\n    }\n  } catch (e) {}\n}\n\n// Source: https://stackoverflow.com/a/14810722/4642943\n// returns a new object with the values at each key mapped using mapFn(value)\nexport const objectMap = (object, mapFn) =>\n  Object.keys(object).reduce(function(result, key) {\n    result[key] = mapFn(object[key])\n    return result\n  }, {});\n\n/**\n * Returns a heavily abbreviated pretty printed date using date-fns\n * - Only includes time if within a week and not midnight\n * - Only includes minutes if nonzero\n * - Replaces date with \"Tomorrow\", \"Next Fri\" or \"Last Wed\", etc.\n */\nexport const prettyPrintDate = epochMilliseconds => {\n  const date = new Date(epochMilliseconds);\n  const now = new Date();\n\n  const getDate = date => {\n    const diff = fn.differenceInCalendarDays(date, now);\n    const weekDiff = fn.differenceInCalendarWeeks(date, now, { weekStartsOn: 1 });\n    const yearDiff = fn.differenceInCalendarYears(date, now);\n\n    // Relative dates are quite ambiguous in English\n    // If today is Wednesday 23 September 2020, then the following mappings are adhered to:\n\n    // 15/9/19: 15 Sep 2019\n    // 15/9/20: 15 Sep\n    // 16/9/20: Last Wed\n    // 21/9/20: Last Mon\n    // 22/9/20: Yesterday\n    // 23/9/20: Today\n    // 24/9/20: Tomorrow\n    // 25/9/20: Fri\n    // 27/9/20: Sun\n    // 28/9/20: Next Mon\n    // 7/10/20: Wed Week\n\n    if (diff ===  0) return \"Today\";\n    if (diff === -1) return \"Yesterday\";\n    if (diff ===  1) return \"Tomorrow\";\n\n    const day = fn.format(date, \"EEE\"); // eg Mon, Thu\n\n    if (weekDiff === 0 && diff >= 0) return day;\n\n    if (diff >= -7 && diff <   0) return `Last ${day}`;\n    if (diff >   0 && diff <=  7) return `Next ${day}`;\n    if (diff >   7 && diff <= 14) return `${day} Week`;\n\n    if (yearDiff === 0)\n      return fn.format(date, \"MMM do\"); // eg: Sep 17th\n    else\n      return fn.format(date, \"MMM do yyyy\"); // eg: Sep 17th 2021 if it's 2020\n  }\n\n  const getTime = date => {\n    // ignore time if midnight\n    if (date.getHours() === 0 && date.getMinutes() === 0) return null;\n    // No minutes; eg 4PM\n    if (date.getMinutes() === 0) return fn.format(date, \"haaa\");\n    return fn.format(date, \"h:mmaaa\");\n  }\n\n  const time = getTime(date);\n  return getDate(date) + (time ? \" \" + time : \"\");\n};\n\n// Web: Download content as filename with specificed MIME type\nexport const downloadData = (content, filename, type) => {\n    if(!type) type = 'application/octet-stream';\n    const a = document.createElement('a');\n    const blob = new Blob([content], { type });\n    a.href = window.URL.createObjectURL(blob);\n    a.download = filename;\n    a.click();\n}\n\n// Web: returns the current hash location (excluding the '#' symbol)\n// Based on https://codesandbox.io/s/wouter-hash-based-hook-5fp9g\nconst currentLoc = () => window.location.hash.replace(\"#\", \"\") || \"/\";\nexport const useHashLocation = () => {\n  const [loc, setLoc] = React.useState(currentLoc());\n  React.useEffect(() => {\n    const handler = () => setLoc(currentLoc());\n    window.addEventListener(\"hashchange\", handler);\n    return () => window.removeEventListener(\"hashchange\", handler);\n  }, []);\n  const navigate = React.useCallback(to => window.location.hash = to, []);\n  const navigateNoHistory = React.useCallback(to => {\n    history.replaceState(undefined, undefined, \"#\"+to);\n    setLoc(to); // because handler does not detect replaceState\n  }, []);\n  return [loc, navigate, navigateNoHistory];\n};\n\nexport const linkName = card => {\n  if (!card) return 'unknown';\n  const firstLine = card.content.split('\\n')[0];\n  if (firstLine.length > 40) return firstLine.substring(0,37) + '...';\n  return firstLine;\n};\nexport const parseWikilinks = (source, cards, prefix = '#/notes/') => {\n  const regex = /(\\[\\[[A-Za-z0-9_-]+\\]\\])/gm; // assumes card IDs are alphanumeric + dash + underscore\n  let m;\n  while ((m = regex.exec(source)) !== null) {\n    if (m.index === regex.lastIndex) regex.lastIndex++;\n    // m.index is the index in 'source'\n    const parseable = (source.substring(0, m.index).match(/`/gm) || []).length % 2 === 0;\n    if (!parseable) continue;\n\n    // m[1] is the actual match\n    let cardID = m[1].substring(2, m[1].length - 2);\n\n    // replace [[CARD_ID]] with [CARD_NAME](#/notes/CARD_ID)\n    let before = source.substring(0, m.index),\n        name = linkName(cards[cardID]),\n        link = prefix + cardID,\n        after = source.substring(m.index + m[1].length, source.length);\n    source = before + `[${name}](${link})` + after;\n  }\n  return source;\n};\n\n// Source: https://www.davedrinks.coffee/how-do-i-use-two-react-refs/\nexport const mergeRefs = (...refs) => {\n  const filteredRefs = refs.filter(Boolean);\n  if (!filteredRefs.length) return null;\n  if (filteredRefs.length === 0) return filteredRefs[0];\n  return inst => {\n    for (const ref of filteredRefs) {\n      if (typeof ref === 'function') {\n        ref(inst);\n      } else if (ref) {\n        ref.current = inst;\n      }\n    }\n  };\n};\n\n// Simple card search; searches titles then descriptions then IDs for case insensitive exact matches\nexport const searchCards = (term, cards, limit=10) => {\n  let matches = [];\n  let tl = term.toLowerCase();\n  for (const cardID in cards) {\n    if (cards[cardID].content.toLowerCase().includes(tl)) {\n      matches.push(cardID);\n      if (matches.length === limit) return matches;\n    }\n  }\n  for (const cardID in cards) {\n    if (cards[cardID].description && cards[cardID].description.toLowerCase().includes(tl)) {\n      matches.push(cardID);\n      if (matches.length === limit) return matches;\n    }\n  }\n  for (const cardID in cards) {\n    if (cardID.toLowerCase().includes(tl)) {\n      matches.push(cardID);\n      if (matches.length === limit) return matches;\n    }\n  }\n  return matches;\n}\n\n// Note: ReloadProtect does not prevent hash changes. Be warned!\nexport const ReloadProtect = ({ shouldProtect = true }) => {\n  React.useEffect(() => {\n    // componentDidMount\n    if (shouldProtect)\n      window.onbeforeunload = e => \"Are you sure you want to quit?\";\n    // componentWillUnmount\n    return () => window.onbeforeunload = null;\n  });\n  return null;\n}\n","\n// Popover menu (web)\nimport * as React from 'react';\nimport { Menu, MenuItem } from '@material-ui/core';\n\n\nexport default ({ map, children }) => {\n  const [anchorEl, setAnchorEl] = React.useState(null);\n  const handleClose = () => setAnchorEl(null);\n\n  return (\n    <React.Fragment>\n      <Menu\n        anchorEl={anchorEl}\n        keepMounted\n        open={Boolean(anchorEl)}\n        onClose={handleClose}>\n        {Object.entries(map).map(([name, func]) => (\n          <MenuItem key={name}\n            onClick={() => { handleClose(); func() }}>\n            {name}\n          </MenuItem>\n        ))}\n      </Menu>\n      {React.cloneElement(children, {\n        onClick: e => setAnchorEl(e.currentTarget)\n      })}\n    </React.Fragment>\n  );\n}\n","\n/**\n * TabView component\n *\n * <TabView\n *   tabs={[\"one\", \"two\", \"three\"]}\n *   render={i => (<SomeComponent index={i} />)}\n * />\n *\n */\n\nimport * as React from 'react';\nimport { AppBar, Tabs, Tab, IconButton } from '@material-ui/core';\nimport MoreIcon from '@material-ui/icons/MoreVert';\nimport PopoverMenu from './popovermenu';\nimport { DragDropContext, Droppable, Draggable } from 'react-beautiful-dnd';\n\nconst TabPanel = ({ show, children }) => (\n  <div hidden={!show} style={{ height: 'calc(100% - 48px)' }}>\n    {show && children}\n  </div>\n);\n\nexport default ({\n  tabs, render, children, index, setIndex,\n  addTab, renameTab, deleteTab, moveTab\n}) => {\n  const handleChange = (event, newValue) => newValue >= 0 && newValue < tabs.length && setIndex(newValue);\n\n  return (\n    <div style={{ flex: 1 }}>\n      <AppBar position=\"static\" style={{\n          backgroundColor: \"white\",\n          zIndex: 2, position: 'relative'\n        }}>\n        <Tabs value={index} onChange={handleChange}\n          indicatorColor=\"primary\" textColor=\"primary\">\n          {tabs.map(tab => (\n            <Tab label={tab} key={tab} />\n          ))}\n          <div style={{flexGrow: 1}}></div>\n          <PopoverMenu map={{\n            \"Add tab\": () => addTab(),\n            \"Rename tab\": () => renameTab(index),\n            \"Delete tab\": () => deleteTab(index),\n            \"Move tab left\": () => (moveTab([index, index-1]), handleChange(null, index-1)),\n            \"Move tab right\": () => (moveTab([index, index+1]), handleChange(null, index+1)),\n          }}>\n            <IconButton>\n              <MoreIcon />\n            </IconButton>\n          </PopoverMenu>\n          {children}\n        </Tabs>\n      </AppBar>\n      {tabs.map((tab, i) => (\n        <TabPanel show={index === i} key={tab}>\n          {index === i && render(i)}\n        </TabPanel>\n      ))}\n    </div>\n  );\n}\n","\nimport * as React from 'react';\nimport { makeStyles } from '@material-ui/core/styles';\nimport Button from '@material-ui/core/Button';\n\nconst useStyles = makeStyles(theme => ({ button: {} }));\n\nexport default props => (\n  <Button className={useStyles().button} variant=\"contained\" color=\"primary\" {...props} />\n);\n","\n/**\n * Kanban boards core Redux logic\n *\n * State is normalised as { tabs, columns, cards }\n *  where each tab has several columns which contain cards\n *  each has a unique ID as a key in the respective object\n */\n\nimport { createReducer, createAction, createSelector } from '@reduxjs/toolkit';\nimport undoable from 'redux-undo';\nimport { loadState, generateID, objectMap } from '../common/utils';\n\n// Action creators\n\nexport const transferCard = createAction('kanban/TRANSFER_CARD');\nexport const reorderCard = createAction('kanban/REORDER_CARD');\nexport const addCard = createAction('kanban/ADD_CARD'); // takes { content, colID }\nexport const editCardContent = createAction('kanban/EDIT_CARD_CONTENT');//takes {content, cardID}\nexport const editCard = createAction('kanban/EDIT_CARD'); // takes a card object; allows editing all of a card's params\nexport const deleteCard = createAction('kanban/DELETE_CARD');//takes cardID\n\nexport const moveCard = ([srcColID, dstColID, srcIndex, dstIndex]) =>\n  srcColID === dstColID\n    ? reorderCard({ colID: srcColID, srcIndex, dstIndex })\n    : transferCard({ srcColID, dstColID, srcIndex, dstIndex });\n\nexport const addColumn = createAction('kanban/ADD_COLUMN'); // takes { name, tabID }\nexport const deleteColumn = createAction('kanban/DELETE_COLUMN'); // takes string column ID\nexport const renameColumn = createAction('kanban/RENAME_COLUMN'); // takes { colID, name }\nexport const moveColumn = createAction('kanban/MOVE_COLUMN'); // takes [srcIdx, dstIdx, tabIdx]\nexport const archiveCardsInColumn = createAction('kanban/ARCHIVE_ALL_COLUMN'); // takes colID\n\nexport const addTab = createAction('kanban/ADD_TAB'); // takes name\nexport const deleteTab = createAction('kanban/DELETE_TAB'); // takes tabIdx\nexport const renameTab = createAction('kanban/RENAME_TAB'); // takes { tabID, name }\nexport const moveTab = createAction('kanban/MOVE_TAB'); // takes [srcIdx, dstIdx]\n\nexport const addZettel = createAction('zettelkasten/ADD_ZETTEL'); // takes { zettel: {...} }\nexport const editZettel = createAction('zettelkasten/EDIT_ZETTEL'); // takes { zettel }\nexport const deleteZettel = createAction('zettelkasten/DELETE_ZETTEL'); // takes zettelID\nexport const toggleZettelStarred = createAction('zettelkasten/TOGGLE_STARRED'); // takes zettelID\n\n// Helpers\n\n// const indexFromID = (list, id) => list.map(item => item.id === id).indexOf(true);\n// const deleteByID = (list, id) => list.splice(indexFromID(list, id), 1);\nconst deleteInList = (list, elem) => {\n  let index = list.indexOf(elem);\n  if (index !== -1) list.splice(index, 1); // undesired behaviour when splicing at (-1, 1)\n  return index !== -1;\n};\n// const _deleteColumn = (s, id) => {\n//   const colIdx = indexFromID(s.columns, id);\n//   s.columns[colIdx].items.forEach(cardID => deleteByID(s.cards, cardID));\n//   s.tabs.forEach(tab => deleteInList(tab.columns, id));\n//   deleteByID(s.columns, id);\n// };\n\n// Selectors\n\nexport const selectors = {\n  // Map[TabID, Column], Column :: { id, items: List[Card] }, not List[CardID]\n  getColumnsInTabs: state =>\n    objectMap(state.tabs, tab =>\n      tab.columns.map(colID => state.columns[colID]).map(col => ({\n        ...col, items: col.items.map(card => state.cards[card])\n      }))),\n  columns: state => state.columns,\n  tabs: state => state.tabs,\n  tabOrder: state => state.tabOrder,\n  cards: state => state.cards,\n  archivedCards: state => Object.values(state.cards).filter(card => Object.keys(card).indexOf(\"archived\") !== -1),\n  activeCards:   state => Object.values(state.cards).filter(card => Object.keys(card).indexOf(\"archived\") === -1),\n  starredZettels: state => state.starredZettels ? state.starredZettels : [],\n  // gets { [tabID]: list_of_cardIDs }\n  cardsByTab: state => objectMap(state.tabs, tab =>\n    tab.columns.flatMap(colID => state.columns[colID].items)),\n};\n\n// Reducers\n\nexport const\n  KANBAN_CARD_TYPE = 0,\n  ZETTEL_NOTE_TYPE = 1;\n\nconst initialState = loadState();\n\nconst reducer = createReducer(initialState, {\n  [transferCard]: (s, a) => {\n    const { srcColID, dstColID, srcIndex, dstIndex } = a.payload;\n    let srcCol = s.columns[srcColID].items;\n    let dstCol = s.columns[dstColID].items;\n    const [removed] = srcCol.splice(srcIndex, 1);\n    const epochms = new Date().getTime();\n    s.cards[removed].moved = epochms;\n    s.columns[srcColID].edited = epochms;\n    s.columns[dstColID].edited = epochms;\n    dstCol.splice(dstIndex, 0, removed);\n  },\n  [reorderCard]: (s, a) => {\n    const { colID, srcIndex, dstIndex } = a.payload;\n    const epochms = new Date().getTime();\n    s.columns[colID].edited = epochms;\n    let newitems = s.columns[colID].items;\n    const [removed] = newitems.splice(srcIndex, 1);\n    s.cards[removed].moved = epochms;\n    newitems.splice(dstIndex, 0, removed);\n    s.columns[colID].items = newitems;\n  },\n  [addCard]: (s, a) => {\n    const { content, colID } = a.payload;\n    const id = generateID();\n    const epochms = new Date().getTime();\n    // add to cards list\n    s.cards[id] = { id, content, type: KANBAN_CARD_TYPE,\n      created: epochms,  edited: epochms, moved: epochms };\n    s.columns[colID].items.unshift(id); // add to top of column\n    s.columns[colID].edited = epochms;\n  },\n  [deleteColumn]: (s, a) => {\n    const colID = a.payload;\n    const tabIdx = Object.values(s.tabs).map(tab => tab.columns.indexOf(a.payload) !== -1).indexOf(true);\n    if (tabIdx >= 0) s.tabs[s.tabOrder[tabIdx]].edited = new Date().getTime();\n    s.columns[colID].items.forEach(cardID => delete s.cards[cardID]);\n    Object.values(s.tabs).forEach(tab => deleteInList(tab.columns, colID));\n    delete s.columns[colID];\n  },\n  [renameColumn]: (s, a) => {\n    const { colID, name } = a.payload;\n    s.columns[colID].name = name;\n    s.columns[colID].edited = new Date().getTime();\n  },\n  [editCardContent]: (s, a) => {\n    const { cardID, content } = a.payload;\n    s.cards[cardID].content = content;\n    s.cards[cardID].edited = new Date().getTime();\n  },\n  [deleteCard]: (s, a) => {\n    Object.values(s.columns).forEach(col => {\n      if (deleteInList(col.items, a.payload))\n        col.edited = new Date().getTime();\n    });\n    delete s.cards[a.payload];\n  },\n  [addColumn]: (s, a) => {\n    const { tabID, name } = a.payload;\n    const id = generateID();\n    const epochms = new Date().getTime();\n    s.columns[id] = { id, items: [], name, created: epochms, edited: epochms };\n    s.tabs[tabID].columns.push(id);\n    s.tabs[tabID].edited = epochms;\n  },\n  [editCard]: (s, a) => {\n    const { card, colID } = a.payload;\n    const epochms = new Date().getTime();\n    s.cards[card.id] = a.payload.card;\n    s.cards[card.id].edited = epochms;\n    const srcColID = Object.keys(s.columns).filter(colID => s.columns[colID].items.indexOf(card.id) !== -1)[0];\n    const dstColID = colID;\n    if (srcColID !== dstColID) {\n      deleteInList(s.columns[srcColID].items, card.id);\n      s.columns[dstColID].items.unshift(card.id);\n      s.columns[srcColID].edited = s.columns[dstColID].edited = epochms;\n    }\n  },\n  [deleteTab]: (s, a) => {\n    const tabIdx = a.payload;\n    const tab = s.tabs[s.tabOrder[tabIdx]];\n    while (tab.columns.length) {\n      const colID = tab.columns[0];\n      s.columns[colID].items.forEach(cardID => delete s.cards[cardID]);\n      delete s.columns[colID];\n      tab.columns.shift();\n    }\n    delete s.tabs[s.tabOrder[tabIdx]];\n    s.tabOrder.splice(tabIdx, 1);\n  },\n  [addTab]: (s, a) => {\n    const id = generateID();\n    const name = a.payload;\n    s.tabs[id] = { name, id, columns: [], created: new Date().getTime() };\n    s.tabOrder.push(id);\n  },\n  [renameTab]: (s, a) => {\n    const { tabID, name } = a.payload;\n    s.tabs[tabID].name = name;\n    s.tabs[tabID].edited = new Date().getTime();\n  },\n  [moveColumn]: (s, a) => {\n    const [srcIdx, dstIdx, tabIdx] = a.payload;\n    const tabID = s.tabOrder[tabIdx];\n    let newitems = s.tabs[tabID].columns;\n    const [removed] = newitems.splice(srcIdx, 1);\n    newitems.splice(dstIdx, 0, removed);\n    s.tabs[tabID].columns = newitems;\n    s.tabs[tabID].edited = new Date().getTime();\n  },\n  [moveTab]: (s, a) => {\n    const [srcIdx, dstIdx] = a.payload;\n    if (dstIdx < 0 || dstIdx >= s.tabs.length) return;\n    let newitems = s.tabOrder;\n    const [removed] = newitems.splice(srcIdx, 1);\n    newitems.splice(dstIdx, 0, removed);\n    s.tabOrder = newitems;\n  },\n  [archiveCardsInColumn]: (s, a) => {\n    // archived cards still exist in memory but are not listed in a column's items\n    const colID = a.payload;\n    const epochms = new Date().getTime();\n    s.columns[colID].items.forEach(cardID => {\n      let card = s.cards[cardID];\n      card.moved = card.edited = card.archived = epochms;\n      card.archivedFromColID = a.payload;\n    });\n    s.columns[colID].items = [];\n    s.columns[colID].edited = epochms;\n  },\n  [addZettel]: (s, a) => {\n    const { zettel } = a.payload;\n    const id = zettel.id || generateID();\n    const epochms = new Date().getTime();\n    s.cards[id] = { id, type: ZETTEL_NOTE_TYPE, created: epochms,  edited: epochms, moved: epochms,\n      ...zettel };\n  },\n  [editZettel]: (s, a) => {\n    const { zettel } = a.payload;\n    const epochms = new Date().getTime();\n    // editZettel does not add new zettels\n    if (Object.keys(s.cards).indexOf(zettel.id) === -1) return;\n    s.cards[zettel.id] = zettel;\n    s.cards[zettel.id].edited = epochms;\n  },\n  [deleteZettel]: (s, a) => {\n    // TODO: clean up links?\n    delete s.cards[a.payload];\n  },\n  [toggleZettelStarred]: (s, a) => {\n    if (!s.starredZettels) s.starredZettels = [];\n    if (s.starredZettels.indexOf(a.payload) === -1)\n      s.starredZettels.push(a.payload);\n    else\n      deleteInList(s.starredZettels, a.payload);\n  },\n});\n\nexport default undoable(reducer, {limit:20});\n","\nimport { combineReducers } from 'redux';\nimport { configureStore } from '@reduxjs/toolkit';\nimport thunk from 'redux-thunk';\nimport { ActionCreators as UndoActionCreators } from 'redux-undo';\nimport boards, { selectors as boardSelectors } from './ducks/kanban';\nimport { saveState, objectMap } from './common/utils';\n\nconst store = configureStore({\n  reducer: boards,\n  middleware: getDefault => getDefault().concat(thunk),\n});\n\n// Undo/redo keyboard shortcuts if supported\ntry {\n  document.addEventListener('keyup', e => {\n    const ignored = ['input', 'textarea'];\n    if (ignored.indexOf(document.activeElement.tagName.toLowerCase()) !== -1) return;\n    if (e.ctrlKey && e.which === 90 && !e.shiftKey)\n      store.dispatch(UndoActionCreators.undo());\n    else if (e.ctrlKey && e.shiftKey && e.which === 90 || e.ctrlKey && e.which === 89)\n      store.dispatch(UndoActionCreators.redo());\n  });\n} catch (e) {}\n\nexport default store;\n\n// produce global selectors\nexport const globalSelectors = {\n  boards: state => state.present\n}\nexport const selectors = {\n  boards: objectMap(boardSelectors, localSelector => state => localSelector(globalSelectors.boards(state)))\n};\n\n// Save board state (excluding history)\n// to save history efficiently we would need to store a state 50 states ago, the 50 actions since,\n// and the current state; this would require a rewrite of redux-undo\nconst localStorageSubscriber = () => saveState(globalSelectors.boards(store.getState()));\nstore.subscribe(localStorageSubscriber);\nlocalStorageSubscriber(); // save data generated on first run\n","\nimport * as React from 'react';\nimport ReactMarkdown from 'react-markdown';\nimport htmlParser from 'react-markdown/plugins/html-parser';\nimport { parseWikilinks } from '../common/utils';\n\n// // See https://github.com/aknuds1/html-to-react#with-custom-processing-instructions for docs\n// const parseHtml = htmlParser({\n//   isValidNode: node => ['script', 'style', 'iframe'].indexOf(node.type) === -1\n// });\n\n// parses wikilinks if the cards prop is present\nexport default props => {\n  const source = props.cards ? parseWikilinks(props.source, props.cards) : props.source;\n  return (\n    <ReactMarkdown\n      source={source}\n      escapeHtml={false}\n    />\n  );\n};\n","\nimport * as React from 'react';\nimport { TextField } from '@material-ui/core';\nimport { Textcomplete } from '@textcomplete/core';\nimport { TextareaEditor } from '@textcomplete/textarea';\nimport { selectors } from '../store';\nimport { useSelector } from 'react-redux';\nimport { searchCards, linkName, generateID } from '../common/utils';\n\n// If addNote is a function an 'Add note' option will appear\n// It inserts a link to a note with a generated ID, and invokes\n// addNote on the generated ID.\nexport default ({ value, setValue, autoFocus = false, addNote, rowsMax = 24 }) => {\n\n  const inputRef = React.useRef(null);\n  const cards = useSelector(selectors.boards.cards);\n\n  React.useEffect(() => {\n    const editor = new TextareaEditor(inputRef.current);\n    const strategy = {\n      // String -> Bool -- whether to proceed to matching phase\n      context: beforeCursor => beforeCursor.indexOf('[[') >= 0,\n      match: /\\[\\[([A-Za-z0-9_ -]+)$/, // captures the X in \"abc [[X\"\n      // term is captured substring; can use async (t, cb) => cb(await something(term));\n      search: (term, callback, match) => callback([...searchCards(term, cards), 0]),\n      cache: true,\n      // these take the input to the search callback\n      template: cardID => cardID === 0 ? (addNote ? `<em>Add note</em>` : '') : linkName(cards[cardID]),\n      replace: cardID => {\n        if (cardID === 0 && addNote) {\n          const id = generateID();\n          // run addNote after replacing text\n          setTimeout(() => addNote(id), 0);\n          return `[[${id}]]`;\n        } else {\n          return `[[${cardID}]]`;\n        }\n      },\n    }\n    const options = {\n      dropdown: {\n        rotate: true, // this means vertical wrapping under up/down arrows\n        maxCount: 10,\n      }\n    };\n    const textcomplete = new Textcomplete(editor, [strategy], options);\n    // cleanup\n    return () => (textcomplete.destroy(), delete window['__addNote']);\n  }, [inputRef.current]);\n\n  return (\n    <TextField margin=\"dense\" fullWidth variant=\"outlined\" autoFocus={autoFocus}\n      multiline rows={6} rowsMax={rowsMax} value={value} onChange={e => setValue(e.target.value)}\n      inputProps={{ ref: inputRef }} />\n  );\n};\n","\nimport * as React from 'react';\nimport Markdown from '../../components/markdown';\nimport { ClickAwayListener, TextField, InputLabel } from '@material-ui/core';\nimport NotesIcon from '@material-ui/icons/Notes';\nimport { IndicatorBuilder, AttributeHeader } from '.';\nimport { selectors } from '../../store';\nimport AutocompleteEditor from '../../components/autocomplete-editor';\nimport { useSelector } from 'react-redux';\n\nexport const Edit = ({ card, setCard }) => {\n  const [editingDescription, setEditingDescription] = React.useState(false);\n  const setDescription = description => setCard({...card,\n      description: description.length ? description : undefined});\n  const cards = useSelector(selectors.boards.cards);\n\n  if (!editingDescription && typeof card.description !== 'string')\n    return (\n      <AttributeHeader onClick={() => setEditingDescription(true)}>\n        Add description\n      </AttributeHeader>\n    );\n\n  return !editingDescription ? (\n    <div style={{marginTop: 8}}>\n      <div onClick={() => setEditingDescription(true)}>\n        <InputLabel className=\"custom-label\">Description</InputLabel>\n      </div>\n      <Markdown source={card.description} cards={cards} />\n    </div>\n  ) : (\n    <React.Fragment>\n      <InputLabel className=\"custom-label\">Description</InputLabel>\n      <ClickAwayListener onClickAway={() => setEditingDescription(false)}>\n        <div style={{width:'100%',height:'100%'}}>\n          <AutocompleteEditor value={card.description} setValue={setDescription} autoFocus />\n        </div>\n      </ClickAwayListener>\n    </React.Fragment>\n  );\n};\n\nexport const Indicator = ({ card }) => {\n  if (card.description) {\n    const limit = 500; // crop after this with ellisis\n    const title = card.description.split(\"\\n\\n\").join(\"\\n\").substring(0, limit);\n      + (card.description.length > limit ? \"...\" : \"\");\n\n    return <IndicatorBuilder label={null} title={title} icon={<NotesIcon />} />;\n  } else return null;\n};\n","\nimport * as React from 'react';\nimport { Button, InputLabel } from '@material-ui/core';\nimport AccessTimeIcon from '@material-ui/icons/AccessTime';\nimport { MuiPickersUtilsProvider, DateTimePicker } from '@material-ui/pickers';\nimport DateFnsUtils from '@date-io/date-fns';\nimport { format, startOfToday } from 'date-fns';\nimport { enAU } from 'date-fns/locale';\nimport { prettyPrintDate } from '../../common/utils';\nimport { IndicatorBuilder, AttributeHeader } from '.';\n\nenAU.weekStart = 1;\n\nexport const Edit = ({ card, setCard }) => {\n  const setDateTime = time => setCard({...card, time});\n\n  return card.time ? (\n    <div style={{marginTop: 10}}>\n      <InputLabel className=\"custom-label\">Date &amp; time</InputLabel>\n      <MuiPickersUtilsProvider utils={DateFnsUtils} locale={enAU}>\n        <DateTimePicker\n          value={new Date(card.time)}\n          onChange={newDate => setDateTime(newDate.getTime())}\n          showTodayButton\n          format=\"MMMM do hh:mm aaa\" />\n      </MuiPickersUtilsProvider>\n      <Button color=\"primary\" variant=\"outlined\" style={{float:'right',marginTop:12}}\n        onClick={() => setDateTime(null)}>Reset date</Button>\n    </div>\n  ) : (\n    <AttributeHeader onClick={() => setDateTime(startOfToday())}>\n      Add date &amp; time\n    </AttributeHeader>\n  );\n};\n\nexport const Indicator = ({ card }) => {\n  if (card.time) {\n    return <IndicatorBuilder\n      icon={<AccessTimeIcon />}\n      label={prettyPrintDate(card.time)}\n      title={format(new Date(card.time), \"dd/MM/yyyy hh:mmaaa\")} />\n  } else return null;\n};\n","\n/**\n * Evidence Based Scheduling card attribute\n * See: https://www.joelonsoftware.com/2007/10/26/evidence-based-scheduling/\n */\n\nimport * as React from 'react';\nimport { useSelector } from 'react-redux';\nimport { Button, TextField, FormControlLabel, Checkbox, InputLabel } from '@material-ui/core';\nimport HourglassEmptyIcon from '@material-ui/icons/HourglassEmpty';\nimport HourglassFullIcon from '@material-ui/icons/HourglassFull';\nimport { globalSelectors as sel } from '../../store';\nimport { IndicatorBuilder, AttributeHeader } from '.';\n\nexport const Edit = ({ card, setCard }) => {\n  // edit a subset of the EBS fields\n  const setEBS = ebsFields => setCard({...card, ebs: {...card.ebs, ...ebsFields}});\n  const [estStr, setEstStr] = React.useState(card.ebs ? prettySeconds(card.ebs.estimate) : \"\");\n  const [elapStr, setElapStr] = React.useState(card.ebs ? prettySeconds(card.ebs.elapsed) : \"\");\n\n  // list of EBS objects for all cards\n  const historical = useSelector(s => Object.values(sel.boards(s).cards)\n    .filter(card => card.hasOwnProperty('ebs') && card.ebs !== null)\n    .filter(card => card.ebs.elapsed && card.ebs.estimate)\n    .map(card => card.ebs));\n\n  const setEBSEstimate = str => {\n    setEstStr(str);\n    const estimate = unprettySeconds(str);\n    if (typeof estimate === \"number\")\n      setEBS({estimate, computed: computeEstimate(estimate, historical)});\n  }\n  const setEBSElapsed = str => {\n    setElapStr(str);\n    const elapsed = unprettySeconds(str);\n    if (typeof elapsed === \"number\")\n      setEBS({elapsed});\n  }\n  const resetEBS = () => (setEstStr(\"\"), setElapStr(\"\"), setCard({...card, ebs: null}));\n\n  if (!card.ebs)\n    return (\n      <AttributeHeader onClick={() => setEBSEstimate('1h')}>\n        Add time estimate\n      </AttributeHeader>\n    );\n\n  // ebs :: { estimate :: seconds, computed :: seconds, elapsed :: seconds,\n  //   done :: boolean, exact :: boolean }\n  // estimate is user estimate, computed is a function of historical estimation accuracy\n  // and elapsed is current time spent on the task, and exact is whether the estimate is exact (eg duration)\n  // TODO: add timer feature or column powerup to automatically time\n\n  const getPrettyPredicted = () => prettySeconds(computeEstimate(unprettySeconds(estStr) || 0, historical));\n\n  // returns true iff the string is non-empty but in incorrect format (not HHhMMm like 1h30m)\n  const invalid = str => str !== \"\" && str !== null && unprettySeconds(str) === null;\n\n  return (\n    <div style={{marginTop: 10}}>\n      <InputLabel className=\"custom-label\">Time estimate</InputLabel>\n      <div style={{width: '30%',float:'left',marginRight:16}}>\n        <TextField label={`Estimate (predicted ${getPrettyPredicted()})`}\n          margin=\"dense\" fullWidth\n          value={estStr}\n          error={invalid(estStr)}\n          helperText={invalid(estStr) ? \"Example format: 1h30m\" : null}\n          onChange={e => setEBSEstimate(e.target.value)} />\n      </div>\n      <div style={{width: '30%',float:'left',marginRight:16}}>\n        <TextField label=\"Elapsed\"\n          margin=\"dense\" fullWidth\n          value={elapStr}\n          error={invalid(elapStr)}\n          helperText={invalid(elapStr) ? \"Example format: 1h30m\" : null}\n          onChange={e => setEBSElapsed(e.target.value)} />\n      </div>\n      <div style={{marginTop: 12, float:'left'}}>\n        <FormControlLabel label=\"Exact duration\" control={\n            <Checkbox color=\"primary\"\n              checked={Boolean(card.ebs.exact)} onChange={e => setEBS({ exact: e.target.checked })} />\n          }/>\n      </div>\n      <div style={{flexGrow:1}}></div>\n      <Button color=\"primary\" variant=\"outlined\" size='medium' style={{float:'right',marginTop:12}}\n        onClick={resetEBS}>Reset estimate</Button>\n    </div>\n  )\n};\n\n// historical :: List[{ estimate, computed, elapsed }]\nconst computeEstimate = (s, historical) => {\n  if (typeof s !== 'number') return s;\n\n  // Compute average ratio elapsed / estimated\n  let ratio = historical.reduce(\n    (acc, ebs) => acc + ebs.elapsed / ebs.estimate / historical.length\n    , 0);\n  // if few samples average with 1\n  if (!ratio) ratio = 1;\n  if (historical.length < 10) ratio = (ratio + 1) / 2;\n\n  // computes an estimate of the time given all of the cards' EBS values\n  const computed = s * ratio;\n\n  // round rough estimate to a reasonable level of precision\n  // nearest hr, 15min or 5min interval if that is the same level of precision as the input\n  const precisions = [3600, 60*15, 60*5];\n  for (let seconds of precisions) {\n    if (s % seconds === 0 && Math.abs(computed - s) > seconds / 2)\n      return seconds * Math.round(computed / seconds);\n  }\n  // otherwise nearest minute\n  return 60 * Math.round(computed / 60);\n};\n\n// Pretty print seconds in short form like 3600->1h, 6300->1h45m (no days or seconds)\nconst prettySeconds = s => {\n  if (typeof (s) === 'string') return s;\n  const hours = Math.floor(s / 3600);\n  const minutes = Math.floor((s % 3600) / 60);\n  if (hours === 0 && minutes === 0) return '0';\n  return (hours ? hours + 'h' : '') + (minutes ? minutes + 'm' : '');\n};\n\n// Inverse of prettySeconds; used so the input field can be edited in pretty form\nlet unprettySeconds = s => {\n  if (s === '0') return 0;\n\n  // this parses it to [x,'1h', '30m'] if possible, or [x,'1h',undefined] or [x,undefined,'30m']\n  // if only one is present, where x is irrelevant\n  let groups = (/^(\\d+h|\\d*\\.\\d+h)?(\\d+m|\\d*\\.\\d+m)?$/m).exec(s);\n\n  // check there are 3 matches where at least one of the latter two are defined\n  if (!groups || groups.length !== 3 || !groups.slice(1).filter(x=>x).length)\n    return null;\n  else groups = groups.slice(1);\n\n  const pf = k => parseFloat(k.substring(0, k.length-1)); // \"1.5h\" -> 1.5\n  return 3600*pf(groups[0] || '00') + 60*pf(groups[1] || '00');\n};\n\nexport const Indicator = ({ card }) => {\n  if (card.ebs) {\n    // display 'elapsed/computed' where the 'elapsed/' is only present if nonzero\n    // displays estimate instead of computed iff card.ebs.exact (checkbox ticked)\n    const label = (card.ebs.elapsed ? prettySeconds(card.ebs.elapsed) + '/' : \"\")\n      + prettySeconds(card.ebs.exact ? card.ebs.estimate : card.ebs.computed);\n    const elapsed = card.ebs.elapsed ? `Elapsed: ${prettySeconds(card.ebs.elapsed)}` : \"\";\n    const title = card.ebs.exact ?\n      `Duration: ${prettySeconds(card.ebs.estimate)}\\n${elapsed}` :\n      `Estimate: ${prettySeconds(card.ebs.estimate)}\\nComputed: ${prettySeconds(card.ebs.computed)}\\n${elapsed}`;\n    // const icon = card.ebs.done ? <HourglassEmptyIcon /> : <HourglassFullIcon />\n    const icon = <HourglassEmptyIcon />;\n    return <IndicatorBuilder label={label} title={title} icon={icon} />;\n  } else return null;\n};\n","\nimport * as React from 'react';\nimport { Chip, makeStyles, Button } from '@material-ui/core';\n\nimport * as Description from './description';\nimport * as DateTime from './datetime';\nimport * as EBS from './ebs';\nexport { Description, DateTime, EBS };\n\nconst useStyles = makeStyles({\n  label: { padding: 3 },\n  header: { marginBottom: 6, marginTop: 6 },\n});\n\nexport const IndicatorBuilder = ({ icon, label, title }) =>\n  <Chip size='small' icon={icon}\n    label={label}\n    title={title}\n    classes={label && label.length ? null : { label: useStyles().label }}\n    style={{ borderRadius: 3, background: 'white', marginRight: 2 }}\n    variant='outlined' />;\n\nexport const AttributeHeader = props =>\n  <div className={useStyles().header}>\n    <Button variant='outlined' color='primary' size='small' {...props} />\n  </div>;\n","\nimport * as React from 'react';\nimport { Button, Dialog, DialogActions, DialogContent, DialogContentText, DialogTitle,\n         TextField, InputLabel, Select, MenuItem,\n         ListSubheader } from '@material-ui/core';\nimport * as duck from '../ducks/kanban';\nimport { globalSelectors as sel, selectors } from '../store';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { Description, DateTime, EBS } from '../kanban/attributes';\nimport { ReloadProtect } from '../common/utils';\n\nexport const ConfirmDialog = ({ open, respond, title, subtitle, labels = [\"Cancel\", \"OK\"] }) => {\n  return (\n    <Dialog open={open} onClose={() => respond(null)}>\n      <DialogTitle>{title}</DialogTitle>\n      <DialogContent>\n        <DialogContentText>\n          {subtitle}\n        </DialogContentText>\n      </DialogContent>\n      <DialogActions>\n        <Button onClick={() => respond(false)} color=\"primary\">\n          {labels[0]}\n        </Button>\n        <Button onClick={() => respond(true)} color=\"primary\" variant=\"contained\" autoFocus>\n          {labels[1]}\n        </Button>\n      </DialogActions>\n    </Dialog>\n  );\n}\n\nexport const PromptDialog = ({\n  open, respond, title, subtitle, labels = [\"Cancel\", \"OK\"],\n  label, inputType = \"text\", placeholder = \"\", buttons = null\n}) => {\n  const [value, setValue] = React.useState(placeholder);\n  const done = x => { respond(x); setValue(placeholder) };\n  return (\n    <Dialog open={open} onClose={() => done(null)}>\n      <DialogTitle>{title}</DialogTitle>\n      <DialogContent>\n        {typeof subtitle === \"string\" && (\n          <DialogContentText>\n            {subtitle}\n          </DialogContentText>\n        )}\n        <TextField autoFocus margin=\"dense\" fullWidth\n          label={label} type={inputType} value={value} onChange={e => setValue(e.target.value)} />\n      </DialogContent>\n      <DialogActions>\n        {buttons}\n        <Button onClick={() => done(false)} color=\"primary\">\n          {labels[0]}\n        </Button>\n        <Button onClick={() => done(value)} color=\"primary\" variant=\"contained\">\n          {labels[1]}\n        </Button>\n      </DialogActions>\n    </Dialog>\n  );\n}\n\nexport const CardEditDialog = ({ respond, card }) => {\n  const dispatch = useDispatch();\n\n  const currentColID = useSelector(state => Object.values(sel.boards(state).columns)\n      .filter(col => col.items.indexOf(card.id) !== -1)[0].id);\n\n  const [colID, setColID] = React.useState(currentColID);\n  const [newCard, setCard] = React.useState(card);\n  const setContent = content => setCard({...newCard, content});\n\n  const columns = useSelector(selectors.boards.columns);\n  const tabs = useSelector(selectors.boards.tabs);\n  const getTabIdxByColID = colID => Object.values(tabs).map(tab => tab.columns.indexOf(colID) !== -1).indexOf(true);\n  const getColIdxByID = colID => Object.values(columns).map(col => col.id === colID).indexOf(true);\n\n  const done = () => (respond(), setContent(card.content));\n  // save and then delete so you can undo the delete without losing your unsaved draft of a card\n  const deleteCard = () => (dispatch(duck.editCard({ card: newCard, colID })), dispatch(duck.deleteCard(card.id)), done());\n  const editCard = () => (dispatch(duck.editCard({ card: newCard, colID })), done());\n\n  return (\n    <Dialog open onClose={() => done(null)} fullWidth maxWidth='md'\n      disableBackdropClick={JSON.stringify(newCard) !== JSON.stringify(card)}>\n      <ReloadProtect shouldProtect={JSON.stringify(newCard) !== JSON.stringify(card)} />\n      <DialogTitle>Edit card</DialogTitle>\n      <DialogContent>\n        <InputLabel id=\"kanban/card-column\" className=\"custom-label\">Column</InputLabel>\n        <Select labelId=\"kanban/card-column\" value={colID} onChange={e => setColID(e.target.value)}>\n          {Object.values(tabs).flatMap(tab => ([\n            // the subheader can be clicked so we add the following CSS hack (per mui#18200)\n            // .MuiListSubheader-root { pointer-events: none; }\n            <ListSubheader key={tab.id}>{tab.name}</ListSubheader>,\n            ...tab.columns.map(colID =>\n              <MenuItem value={colID} key={colID}>{columns[colID].name}</MenuItem>\n            )\n          ]))}\n        </Select>\n        <InputLabel id=\"kanban/card-title\" className=\"custom-label\">Title</InputLabel>\n        <TextField margin=\"dense\" autoFocus fullWidth\n          multiline rowsMax={3} value={newCard.content} onChange={e => setContent(e.target.value)} />\n        <Description.Edit card={newCard} setCard={setCard} />\n        <DateTime.Edit    card={newCard} setCard={setCard} />\n        <EBS.Edit         card={newCard} setCard={setCard} />\n      </DialogContent>\n      <DialogActions>\n        <Button onClick={deleteCard}>Delete</Button>\n        <Button onClick={done} color=\"primary\">Cancel</Button>\n        <Button onClick={editCard} color=\"primary\" variant=\"contained\">OK</Button>\n      </DialogActions>\n    </Dialog>\n  );\n}\n\nexport const AboutDialog = ({ open, respond }) => {\n  return (\n    <Dialog open={open} onClose={respond} fullWidth>\n      <DialogTitle>About Mirror</DialogTitle>\n      <DialogContent>\n        <DialogContentText>\n          A free and open source personal task management and note taking app.<br/>\n\n          Made by Oliver Balfour. &copy; 2020.<br/>\n\n          App icon is <a href=\"https://thenounproject.com/term/mirror/340140/\">Mirror</a>&nbsp;\n          by Lastspark from <a href=\"http://thenounproject.com/\">The Noun Project</a>.\n        </DialogContentText>\n      </DialogContent>\n      <DialogActions>\n        <Button onClick={respond} color=\"primary\" variant=\"contained\" autoFocus>\n          OK\n        </Button>\n      </DialogActions>\n    </Dialog>\n  );\n}\n","\n/**\n * MenuBar component\n *\n * <MenuBar active={0} setActive={...} />\n *  (active is index of current screen)\n *\n */\n\nimport React from 'react';\nimport { AppBar, Toolbar, IconButton, Tabs, Tab } from '@material-ui/core';\nimport MenuIcon from '@material-ui/icons/Menu';\nimport SearchIcon from '@material-ui/icons/Search';\nimport MoreIcon from '@material-ui/icons/MoreVert';\nimport DeveloperBoardIcon from '@material-ui/icons/DeveloperBoard';\nimport NotesIcon from '@material-ui/icons/Notes';\nimport PopoverMenu from './popovermenu';\nimport { downloadData } from '../common/utils';\nimport { AboutDialog } from './dialogs';\n\nexport default ({ active, setActive }) => {\n  const [aboutOpen, setAboutOpen] = React.useState(false);\n  return (\n    <React.Fragment>\n      <AppBar color=\"primary\" style={{ top: 'auto', bottom: 0 }}>\n        <Toolbar style={{ minHeight: 0 }}>\n          <IconButton edge=\"start\" color=\"inherit\" onClick={() => console.log(\"open menu\")}>\n            <MenuIcon />\n          </IconButton>\n          <Tabs\n            value={active} onChange={(e, val) => setActive(val)}\n            TabIndicatorProps={{ style: { backgroundColor: 'white' } }}\n          >\n            <Tab label={<div><DeveloperBoardIcon style={{verticalAlign: 'middle'}} /> Board</div>}  />\n            <Tab label={<div><NotesIcon style={{verticalAlign: 'middle'}} /> Notes</div>}  />\n          </Tabs>\n          <div style={{ flexGrow: 1 }} />\n          <PopoverMenu map={{\n            \"Submit feedback\": () => window.open('mailto'+':oliver.'+'leo.balfour+mirrorsupport'+'@googlemail'+'.com', '_blank'),\n            \"About\": () => setAboutOpen(true),\n            \"Clear saved state\": () => window.prompt(\"Delete all saved state? Pressing undo will fix this. Type YES to confirm\", \"NO\") === \"YES\" && localStorage.clear(),\n            \"Import state\": () => { localStorage.kanban = window.prompt(\"Paste your exported state here. Press cancel (or the undo button after pressing OK) to revert. Refresh the page to confirm and reload state.\") },\n            \"Export state\": () => downloadData(localStorage.kanban, \"mirror-backup.json\", \"application/json\"),\n          }}>\n            <IconButton edge=\"end\" color=\"inherit\">\n              <MoreIcon />\n            </IconButton>\n          </PopoverMenu>\n        </Toolbar>\n      </AppBar>\n      <AboutDialog open={aboutOpen} respond={() => setAboutOpen(false)} />\n    </React.Fragment>\n  );\n}\n","\nimport * as React from 'react';\nimport { useDispatch } from 'react-redux';\nimport { IconButton } from '@material-ui/core';\nimport UndoIcon from '@material-ui/icons/Undo';\nimport RedoIcon from '@material-ui/icons/Redo';\nimport { ActionCreators } from 'redux-undo'\n\nexport default () => {\n  const dispatch = useDispatch();\n  return (\n    <React.Fragment>\n      <IconButton onClick={() => dispatch(ActionCreators.undo())}>\n        <UndoIcon />\n      </IconButton>\n      <IconButton onClick={() => dispatch(ActionCreators.redo())}>\n        <RedoIcon />\n      </IconButton>\n    </React.Fragment>\n  );\n};\n","\n/**\n * Boarddiv component\n *\n * <Boarddiv\n *   tab={tabIndex}\n * />\n *\n */\n\nimport * as React from 'react';\nimport { useSelector, useDispatch } from 'react-redux';\nimport * as duck from '../ducks/kanban';\nimport { selectors, globalSelectors as sel } from '../store';\nimport { makeStyles, Button, IconButton, ButtonGroup, TextField, Chip } from '@material-ui/core';\nimport MoreVertIcon from '@material-ui/icons/MoreVert';\nimport AddIcon from '@material-ui/icons/Add';\nimport DeleteIcon from '@material-ui/icons/Delete';\nimport { DragDropContext, Droppable, Draggable } from 'react-beautiful-dnd';\nimport { PopoverMenu, ConfirmDialog, PromptDialog, CardEditDialog, Markdown } from '../components';\nimport { Description, DateTime, EBS } from './attributes';\nimport { useHashLocation, mergeRefs } from '../common/utils';\n\nconst grid = 8;\nconst cardWidth = 300;\n\nconst useStyles = makeStyles(theme => ({\n  root: {\n    height: '100%',\n    display: 'flex',\n    flexDirection: 'row',\n    flexWrap: 'nowrap',\n    padding: grid,\n    fontSize: \"14px\",\n    \"& *\": {flexShrink: 0},\n  },\n  column: {\n    background: '#DFEEEE',\n    padding: grid,\n    paddingBottom: 24,\n    width: cardWidth,\n    border: '1px solid #CCDCDC',\n    borderRadius: 5,\n    margin: grid,\n    transition: \"border 0.2s\",\n    height: 'calc(100vh - 160px)',\n    overflow: 'hidden',\n  },\n  addColumnContainer: {\n    width: cardWidth + 5*grid,\n  },\n  addColumn: {\n    // we also apply a margin conditionally in the JSX when dragging columns\n    display: 'flex',\n    justifyContent: 'center',\n    alignItems: 'center',\n    height: '100px',\n    background: '#DFEEEE',\n    padding: grid,\n    paddingBottom: 24,\n    width: cardWidth,\n    border: '1px solid #CCDCDC',\n    borderRadius: 5,\n    margin: grid,\n  },\n  columnHeaderContainer: {\n    padding: \"8 0\",\n    display: \"flex\",\n    justifyContent: \"space-between\",\n  },\n  columnHeaderText: {\n    paddingLeft: 8,\n    paddingBottom: 0,\n    fontSize: '1.4em',\n    fontWeight: 500,\n  },\n  columnHeaderRule: {\n    overflow: \"hidden\",\n    border: \"none\",\n    color: \"#CCDCDC\",\n    backgroundColor: \"#CCDCDC\",\n    height: \"1px\",\n    width: cardWidth + grid * 2 + 1, //+1 is border\n    marginLeft: -(grid+1),\n  },\n  card: {\n    userSelect: 'none',\n    padding: \"10px 13px\",\n    margin: `0 0 ${grid}px 0`,\n    background: 'white',\n    borderRadius: 5,\n    transition: \"opacity 0.3s\",\n    overflow: 'hidden',\n    \"&:hover, &:focus\": {\n      boxShadow: '0 1px 3px rgba(100, 100, 100, 0.3)',\n    },\n    \"&>p\": {\n      margin: 0,\n    }\n  },\n  draggingCard: {\n    opacity: 0.7,\n    boxShadow: '0 1px 3px rgba(100, 100, 100, 0.3)',\n  },\n  columnContainer: {\n    transition: \"opacity 0.6s\",\n  },\n  draggingColumn: {\n    opacity: 0.7,\n  },\n}));\n\nexport default ({ tabInfo }) => {\n  const tab = tabInfo.index;\n  const tabObj = tabInfo.tab;\n  const dispatch = useDispatch();\n  const styles = useStyles();\n\n  const tabOrder = useSelector(selectors.boards.tabOrder);\n  const columns = useSelector(selectors.boards.getColumnsInTabs)[tabOrder[tab]];\n  const tabs = useSelector(selectors.boards.tabs);\n  const cards = useSelector(selectors.boards.cards);\n  const colIDs = tabs[tabOrder[tab]].columns;\n\n  // dispatch move card action\n  const onDragEnd = res => {\n    if (!res.destination) return;\n    if (res.type === \"card\") {\n      dispatch(duck.moveCard([\n        res.source.droppableId, res.destination.droppableId,\n        res.source.index, res.destination.index\n      ]));\n    } else if (res.type === \"column\") {\n      dispatch(duck.moveColumn([\n        res.source.index, res.destination.index, tab\n      ]));\n    }\n  };\n\n  const [promptOpen, setPromptOpen] = React.useState(false);\n  const promptRespond = name => setPromptOpen(false) ||\n    typeof name === \"string\" && name.length &&\n      dispatch(duck.addColumn({ tabID: tabObj.id, name }));\n\n  const [loc, setLoc, setLocNoHist] = useHashLocation();\n  // editing card if URL is /board/CARD_ID/edit\n  const editingCard = loc.split(\"/\")[4] === \"edit\" ? loc.split(\"/\")[3] : null;\n\n  const cardsByTab = useSelector(selectors.boards.cardsByTab);\n  const tabIDfromCardID = id => Object.keys(cardsByTab).filter(tabID => cardsByTab[tabID].indexOf(id) !== -1);\n  const setEditingCard = id => id\n    ? setLoc(`/boards/${tabs[tabIDfromCardID(id)].name.toLowerCase()}/${id}/edit`)\n    : setLoc(`/boards/${loc.split(\"/\")[2]}`);\n\n  return (\n    <div style={{ width: '100vw', overflowX: 'auto', height: '100%' }}>\n      <DragDropContext onDragEnd={onDragEnd}>\n        <Droppable droppableId=\"default\" style={{ flexGrow: 1, height: \"100%\" }} direction=\"horizontal\" type=\"column\">\n          {(provided, snapshot) => (\n            <React.Fragment>\n              <div className={styles.root} ref={provided.innerRef}>\n                {colIDs.map((colID, i) => <Column col={columns[i]} styles={styles} key={colID} index={i}\n                  setEditingCard={setEditingCard} />)}\n                <AddColumn styles={styles} add={() => setPromptOpen(true)} hide={snapshot.isDraggingOver || snapshot.draggingFromThisWith} />\n              </div>\n              {provided.placeholder}\n            </React.Fragment>\n          )}\n        </Droppable>\n      </DragDropContext>\n      {promptOpen && (\n        <PromptDialog open respond={promptRespond}\n          title=\"Add column\" label=\"Name\" />\n      )}\n      {editingCard && cards.hasOwnProperty(editingCard) && (\n        <CardEditDialog respond={() => setEditingCard(null)} card={cards[editingCard]} />\n      )}\n    </div>\n  );\n}\n\nconst Column = ({ styles, col, index, setEditingCard }) => {\n  const { id, items, name } = col;\n\n  const [editingNew, setEditingNew] = React.useState(false);\n  const [editingValue, setEditingValue] = React.useState(\"\");\n  const dispatch = useDispatch();\n  const addCard = () => {\n    if (editingValue.length)\n      dispatch(duck.addCard({\n        content: editingValue,\n        colID: id\n      }));\n    setEditingValue(\"\");\n    setEditingNew(false);\n  };\n  const addButton = () => {\n    if (editingNew)\n      setEditingValue(\"\");\n    else\n      // scroll so that the add card section at the top is visible\n      scrollContainerRef.current.scrollTop = 0;\n    setEditingNew(!editingNew);\n  };\n  const scrollContainerRef = React.useRef(null);\n  const menuButton = () => {\n    console.log('pressed menu button');\n  };\n  const internals = (\n    <Droppable droppableId={id} style={{ flexGrow: 1, height: \"100%\" }} type=\"card\" ignoreContainerClipping>\n      {(provided, snapshot) => (\n        <React.Fragment>\n          <div style={{\n              width: cardWidth, overflowY: 'auto', overflowX: 'hidden',\n              // 1) height is -20px to avoid bottom being clipped off\n              // 2) 100px padding and -100px height while dragging to give a 100px buffer of\n              // droppable space to avoid glitching due to dynamic resizing while moving\n              // cards to the bottom\n              height: snapshot.isDraggingOver ? \"calc(100% - 120px)\" : \"calc(100% - 20px)\",\n              paddingBottom: snapshot.isDraggingOver ? 100 : 0\n            }} ref={mergeRefs(provided.innerRef, scrollContainerRef)}>\n            {editingNew && (\n              <EditingCard value={editingValue} setValue={setEditingValue}\n                add={addCard} cancel={() => { setEditingValue(\"\"); setEditingNew(false) }} />\n            )}\n            {items.map((card, index) => card ? <Card card={card} styles={styles} index={index} key={card.id}\n              setEditingCard={setEditingCard} /> : null)}\n          </div>\n          {provided.placeholder}\n        </React.Fragment>\n      )}\n    </Droppable>\n  );\n\n  return (\n    <Draggable draggableId={id} index={index}>\n      {(provided, snapshot) => (\n        <div ref={provided.innerRef}\n          {...provided.draggableProps}\n          className={styles.columnContainer + (snapshot.isDragging ? \" \"+styles.draggingColumn : \"\")}\n          style={provided.draggableProps.style}>\n          <div className={styles.column}>\n            <div {...provided.dragHandleProps}>\n              <ColumnHeader styles={styles} col={col} add={addButton} menu={menuButton} />\n            </div>\n            {internals}\n          </div>\n        </div>\n      )}\n    </Draggable>\n  );\n}\n\nconst EditingCard = ({ value, setValue, add, cancel }) => {\n  return (\n    <div>\n      <TextField\n        label=\"New Card\"\n        multiline\n        autoFocus\n        rowsMax={6}\n        value={value}\n        onChange={e => setValue(e.target.value)}\n        variant=\"filled\"\n        style={{ width: \"100%\" }} />\n      <ButtonGroup variant=\"contained\" size='small'\n        style={{marginBottom: 8, boxShadow: \"0px 4px 2px -2px rgba(0,0,0,0.15)\", width: \"100%\"}}>\n        <Button style={{flexGrow: 1}} variant='contained' onClick={add}>\n          Done\n        </Button>\n        <Button onClick={cancel}><DeleteIcon style={{color: '#555'}} /></Button>\n      </ButtonGroup>\n    </div>\n  );\n};\n\n// header name, add button, chips for each addon (WIP limit, EBS time estimate, etc), menu button\nconst ColumnHeader = ({ styles, col, add, menu }) => {\n  const dispatch = useDispatch();\n\n  const [confirmOpen, setConfirmOpen] = React.useState(false);\n  const confirmRespond = res => setConfirmOpen(false) ||\n    res && dispatch(duck.deleteColumn(col.id));\n\n  const [promptOpen, setPromptOpen] = React.useState(false);\n  const promptRespond = res => setPromptOpen(false) ||\n    typeof res === \"string\" && res.length &&\n      dispatch(duck.renameColumn({ colID: col.id, name: res }));\n\n  const archiveAll = () => dispatch(duck.archiveCardsInColumn(col.id));\n\n  return (\n    <div>\n      <div className={styles.columnHeaderContainer}>\n        <div className={styles.columnHeaderText}>\n          {col.name}\n        </div>\n        <div>\n          {/*\n            // TODO: column powerup API with Chip indicators\n            <Chip size='small' label=\"0/6\" />\n            <Chip size='small' label=\"3h\" />\n          */}\n          <IconButton size='small' onClick={() => add()}>\n            <AddIcon />\n          </IconButton>\n          <PopoverMenu map={{\n            \"Archive all\": () => archiveAll(),\n            \"Rename\": () => setPromptOpen(true),\n            \"Delete\": () => setConfirmOpen(true),\n          }}>\n            <IconButton size='small'>\n              <MoreVertIcon />\n            </IconButton>\n          </PopoverMenu>\n        </div>\n      </div>\n      <hr className={styles.columnHeaderRule} />\n      {confirmOpen && (\n        <ConfirmDialog open respond={confirmRespond}\n          title=\"Delete this column?\" subtitle=\"Don't worry, this action can be undone.\" />\n      )}\n      {promptOpen && (\n        <PromptDialog open respond={promptRespond}\n          title={`Rename column \"${col.name}\"`} subtitle=\"Don't worry, this action can be undone.\"\n          label=\"Name\" placeholder={col.name} />\n      )}\n    </div>\n  );\n};\n\nconst Card = ({ card, styles, index, setEditingCard }) => {\n  const cards = useSelector(selectors.boards.cards);\n  if (!card) return null;\n  const { id, content } = card;\n\n  return (\n    <React.Fragment>\n      <Draggable draggableId={id} index={index}>\n        {(provided, snapshot) => (\n          <div ref={provided.innerRef}\n            {...provided.draggableProps}\n            {...provided.dragHandleProps}\n            className={styles.card + (snapshot.isDragging ? \" \"+styles.draggingCard : \"\")}\n            style={provided.draggableProps.style}\n            onClick={() => setEditingCard(id)}>\n            <Markdown source={content} cards={cards} />\n            <Description.Indicator card={card} />\n            <DateTime.Indicator    card={card} />\n            <EBS.Indicator         card={card} />\n          </div>\n        )}\n      </Draggable>\n    </React.Fragment>\n  );\n}\n\nconst AddColumn = ({ styles, add, hide }) => {\n  return (\n    <div className={styles.addColumnContainer} style={{\n      marginLeft: hide ? cardWidth + 4*grid + 2 : 0 }}>\n      <div className={styles.addColumn}>\n        <IconButton onClick={add}>\n          <AddIcon />\n        </IconButton>\n      </div>\n    </div>\n  );\n}\n","\nimport * as React from 'react';\nimport { useSelector, useDispatch } from 'react-redux';\nimport { TabView, UndoRedo } from '../components';\nimport BoardView from './boardview';\nimport * as duck from '../ducks/kanban';\nimport { selectors } from '../store';\nimport { PopoverMenu, ConfirmDialog, PromptDialog } from '../components';\nimport { useHashLocation } from '../common/utils';\n\nexport default () => {\n  const dispatch = useDispatch();\n  const [loc, setLoc] = useHashLocation();\n  // {id:{name, id, columns (ids)},...}\n  const tabs = useSelector(selectors.boards.tabs);\n  const tabOrder = useSelector(selectors.boards.tabOrder);\n  let currentTab = tabOrder.map(tabID => tabs[tabID].name.toLowerCase() === loc.split(\"/\")[2]).indexOf(true);\n  const setCurrentTab = num => setLoc(\"/boards/\"+tabs[tabOrder[num]].name.toLowerCase());\n  if (currentTab < 0) currentTab = 0;\n\n  const [confirmOpen, setConfirmOpen] = React.useState(false);\n  const confirmRespond = res => setConfirmOpen(false) ||\n    res && (dispatch(duck.deleteTab(currentTab)), setCurrentTab(Math.max(0,currentTab-1)));\n\n  const [addPromptOpen, setAddPromptOpen] = React.useState(false);\n  const addPromptRespond = res => setAddPromptOpen(false) ||\n    typeof res === \"string\" && res.length &&\n      dispatch(duck.addTab(res));\n\n  const [renamePromptOpen, setRenamePromptOpen] = React.useState(false);\n  const renamePromptRespond = res => setRenamePromptOpen(false) ||\n    typeof res === \"string\" && res.length &&\n      dispatch(duck.renameTab({ tabID: tabOrder[currentTab], name: res }));\n\n  return (\n    <React.Fragment>\n      <TabView\n        tabs={tabOrder.map(tabID => tabs[tabID].name)}\n        render={i => <BoardView tabInfo={{ tab: tabs[tabOrder[i]], index: i }} />}\n        addTab={() => setAddPromptOpen(true)}\n        renameTab={() => setRenamePromptOpen(true)}\n        deleteTab={() => Object.values(tabs).length > 1 ? setConfirmOpen(true) : alert(\"Cannot delete only tab\")}\n        moveTab={data => dispatch(duck.moveTab(data))}\n        children={<UndoRedo />}\n        index={currentTab} setIndex={setCurrentTab}\n      />\n      {confirmOpen && (\n        <ConfirmDialog open respond={confirmRespond}\n          title=\"Delete this tab?\" subtitle=\"Don't worry, this action can be undone.\" />\n      )}\n      {addPromptOpen && (\n        <PromptDialog open respond={addPromptRespond} title=\"Add tab\" label=\"Name\" />\n      )}\n      {renamePromptOpen && (\n        <PromptDialog open respond={renamePromptRespond}\n          title={`Rename tab ${tabs[tabOrder[currentTab]].name}`} label=\"Name\" />\n      )}\n    </React.Fragment>\n  );\n}\n","\nimport * as React from 'react';\nimport { useHashLocation, parseWikilinks, generateID, ReloadProtect } from '../common/utils';\nimport { selectors } from '../store';\nimport { useSelector, useDispatch } from 'react-redux';\nimport { Markdown, AutocompleteEditor } from '../components';\nimport { makeStyles, TextField, Button, ButtonGroup } from '@material-ui/core';\nimport EditIcon from '@material-ui/icons/Edit';\nimport DeleteIcon from '@material-ui/icons/Delete';\nimport AddIcon from '@material-ui/icons/Add';\nimport SearchIcon from '@material-ui/icons/Search';\nimport StarIcon from '@material-ui/icons/Star';\nimport StarBorderIcon from '@material-ui/icons/StarBorder';\nimport * as duck from '../ducks/kanban.js';\n\nconst useStyles = makeStyles(theme => ({\n  container: {\n    background: '#DFEEEE',\n    position: 'absolute',\n    top: 0, left: 0, bottom: 0, right: 0,\n    display: 'flex',\n    justifyContent: 'center',\n    alignItems: 'flex-start',\n    padding: 10,\n  },\n  zettel: {\n    background: 'white',\n    borderRadius: 5,\n    width: 650,\n    margin: 10,\n    marginTop: 70,\n    boxShadow: '0 1px 3px rgba(100, 100, 100, 0.3)',\n    padding: 16,\n    paddingTop: 8, paddingBottom: 12,\n    '&>p': {marginTop: 0},\n    '&>p:last-child': {marginBottom: 0},\n  },\n  zettelTitle: {\n    marginBottom: 8,\n    marginTop: 8,\n    fontSize: 24,\n    fontWeight: 600,\n    textAlign: 'center',\n  },\n  editingButtons: {\n    float: 'right',\n  },\n  buttons: {\n    position: 'absolute',\n    top: 15, left: 0, right: 0,\n    display: 'flex', justifyContent: 'center',\n  },\n}));\n\nexport default () => {\n  const [loc, setLoc, setLocNoHist] = useHashLocation();\n  const dispatch = useDispatch();\n  const cards = useSelector(selectors.boards.cards);\n  const starred = useSelector(selectors.boards.starredZettels);\n  const styles = useStyles();\n\n  const currentCardID = loc.split('/')[2] || 'main'; //#/notes/ID\n  const setCurrentCardID = id => setLoc(`/notes/${id}`);\n\n  const card = cards[currentCardID];\n  const [newCard, setNewCard] = React.useState({ ...card }); // assuming no deep nesting\n  const setCard = part => setNewCard({ ...newCard, ...part });\n\n  if (typeof card !== 'object') return null;\n\n  const editing = loc.split('/')[3] === 'edit'; //#/notes/ID/edit\n  const setEditing = yes => yes\n    ? setLocNoHist(`/notes/${currentCardID}/edit`)\n    : setLocNoHist(`/notes/${currentCardID}`);\n  const cancelEditing = () => (setEditing(false), setNewCard({...card}));\n\n  const deleteZettel = () => (dispatch(duck.deleteCard(currentCardID)), setLocNoHist('/notes/main'));\n  const saveZettel = zettel => (dispatch(duck.editZettel({ zettel })), setEditing(false));\n  const starZettel = () => dispatch(duck.toggleZettelStarred(currentCardID));\n\n  // update editing field on card change\n  if (card.id !== newCard.id) {\n    // We want to save the card if the 'Add note' button was pressed\n    // The only time a card is not saved is if you press cancel or delete\n    dispatch(duck.editZettel({ zettel: newCard }));\n    setNewCard({ ...card });\n  };\n\n  const addZettel = id => {\n    // create a new card and navigate to editing it\n    dispatch(duck.addZettel({ zettel: { content: 'New note', description: '...', id } }));\n    setLoc(`/notes/${id}/edit`);\n  };\n\n  const addNewNote = id => {\n    dispatch(duck.editZettel({ zettel: newCard }));\n    addZettel(id);\n  }\n\n  return (\n    <React.Fragment>\n      <ReloadProtect shouldProtect={JSON.stringify(newCard) !== JSON.stringify(card)} />\n      <div className={styles.container}>\n        {editing && (\n          <div className={styles.zettel}>\n            <TextField margin=\"dense\" autoFocus fullWidth\n              multiline rowsMax={3} value={newCard.content || ''} onChange={e => setCard({ content: e.target.value })} />\n            <AutocompleteEditor value={newCard.description || ''} setValue={description => setCard({ description })}\n              addNote={addNewNote} rowsMax={30} />\n            <div className={styles.editingButtons}>\n              <Button onClick={cancelEditing} color=\"primary\">Cancel</Button>\n              <Button onClick={() => saveZettel(newCard)} color=\"primary\" variant=\"contained\">Save</Button>\n            </div>\n          </div>\n        )}\n        <div className={styles.zettel + (editing ? ' notes-editing' : '')}>\n          <div className={styles.zettelTitle}>\n            {(editing ? newCard.content : card.content) || ''}\n          </div>\n          <Markdown source={(editing ? newCard.description : card.description) || ''} cards={cards} />\n        </div>\n      </div>\n      <div className={styles.buttons} id='zettel-buttons-container'>\n        <ButtonGroup variant='contained' color='primary'>\n          {!editing && (\n            <Button onClick={() => setEditing(true)} title=\"Edit note\">\n              <EditIcon />\n            </Button>\n          )}\n          {card.id !== 'main' && (\n            <Button onClick={deleteZettel} title=\"Delete note\">\n              <DeleteIcon />\n            </Button>\n          )}\n          {!editing && (\n            <Button onClick={() => addZettel(generateID())} title=\"Add note\">\n              <AddIcon />\n            </Button>\n          )}\n          <Button onClick={() => alert('TODO')} title=\"Search notes\">\n            <SearchIcon />\n          </Button>\n          {starred.indexOf(card.id) === -1 ? (\n            <Button onClick={starZettel} title=\"Star this note\">\n              <StarBorderIcon />\n            </Button>\n          ) : (\n            <Button onClick={starZettel} title=\"Unstar this note\">\n              <StarIcon />\n            </Button>\n          )}\n        </ButtonGroup>\n      </div>\n    </React.Fragment>\n  );\n};\n","\n/**\n * app.js\n * Main JSX source file for the app\n * Details like screen size and renderer are abstracted away by index.[platform].js\n * and ../index.js\n */\n\nimport React from 'react';\nimport { Provider } from 'react-redux';\nimport { useHashLocation } from './common/utils';\n// import { createMuiTheme, ThemeProvider } from '@material-ui/core';\n\nimport { Button, MenuBar } from './components';\nimport Kanban from './kanban';\nimport Zettelkasten from './zettelkasten';\nimport store, { globalSelectors as sel } from './store';\n\nconst screenNames = [\"/boards\", \"/notes\"];\nconst getScreen = loc => {\n  const name = \"/\" + loc.split(\"/\")[1]; // strip to / or /boards, etc\n  return Math.max(screenNames.indexOf(name), 0);\n};\nconst getScreenName = n => {\n  if (n === 0) {\n    // boards get special treatment of /boards/FIRST_TAB\n    const state = sel.boards(store.getState());\n    return \"/boards/\" + state.tabs[state.tabOrder[0]].name.toLowerCase();;\n  } else return screenNames[n];\n}\n\n// const theme = createMuiTheme({\n//   palette: {\n//     // primary: { main: '#1976d2', dark: '#1466b8' },\n//   },\n// });\n\nexport default () => {\n  const [loc, setLoc] = useHashLocation();\n  const active = getScreen(loc);\n  const setActive = n => setLoc(getScreenName(n));\n  const style = { height: \"calc(100% - 48px)\" };\n\n  return (\n    <Provider store={store}>\n      {/*<ThemeProvider theme={theme}>*/}\n        <div style={{ top: 0, left: 0, height: \"100%\", width: \"100%\", display: \"flex\", flexDirection: \"column\" }}>\n\n          <div style={style}>\n            { active === 0 && (\n              <Kanban />\n            )}\n            { active === 1 && (\n              <Zettelkasten />\n            )}\n          </div>\n\n          <MenuBar active={active} setActive={setActive} />\n\n        </div>\n      {/*</ThemeProvider>*/}\n    </Provider>\n  );\n}\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport Application from './app.js';\nimport * as serviceWorker from './serviceWorker';\nimport './index.css';\n\nReactDOM.render(\n  <Application/>,\n  document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}