(this.webpackJsonpmirror=this.webpackJsonpmirror||[]).push([[0],{10:function(e,t,n){"use strict";n.d(t,"i",(function(){return r})),n.d(t,"d",(function(){return a})),n.d(t,"m",(function(){return c})),n.d(t,"l",(function(){return o})),n.d(t,"j",(function(){return b})),n.d(t,"t",(function(){return h})),n.d(t,"v",(function(){return g})),n.d(t,"u",(function(){return O})),n.d(t,"s",(function(){return E})),n.d(t,"c",(function(){return y})),n.d(t,"a",(function(){return j})),n.d(t,"b",(function(){return w})),n.d(t,"n",(function(){return D})),n.d(t,"h",(function(){return _})),n.d(t,"r",(function(){return N})),n.d(t,"k",(function(){return I})),n.d(t,"p",(function(){return A})),n.d(t,"g",(function(){return L})),n.d(t,"q",(function(){return H})),n.d(t,"f",(function(){return M})),n.d(t,"o",(function(){return z})),n.d(t,"e",(function(){return B}));var r=function(e){if(!e)return"unknown";var t=e.content.split("\n")[0];return t.length>40?t.substring(0,37)+"...":t},a=function(e){if(!e)return"";var t=e?"string"===typeof e?e:e.description||e.content:"unknown";return t.split("\n\n").join("\n").substring(0,500)+(t.length>500?"...":"")},c=function(e,t){for(var n,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"#/notes/",c=/(\[\[[A-Za-z0-9_-]+\]\])/gm;null!==(n=c.exec(e));){n.index===c.lastIndex&&c.lastIndex++;var i=(e.substring(0,n.index).match(/`/gm)||[]).length%2===0;if(i){var o=n[1].substring(2,n[1].length-2),u=e.substring(0,n.index),l=r(t[o]),s=a+o,d=e.substring(n.index+n[1].length,e.length);e=u+"[".concat(l,"](").concat(s,")")+d}}return e},i=function(e,t){return((e||"").match(t)||[]).length},o=function(e,t){if(-1===e.indexOf("$$"))return e;var n=/<p>\$\$([^\n]+)\$\$<\/p>/m,r=/\$\$([^\n]+)\$\$/m,a=function(e,n){return t.renderToString(e,{throwOnError:!1,displayMode:n})},c=function(e,t){for(var c=0,o=t?n:r,u=e.match(o),l=0;l<100&&c<e.length&&u;l++){i(e.substring(0,c+u.index),/<(code|pre)[^>]*>/g)===i(e.substring(0,c+u.index),/<\/(code|pre)>/g)&&(e=e.substring(0,u.index+c)+a(u[1],t)+e.substring(u.index+c+u[0].length,e.length)),c+=u.index+u[0].length,u=e.substring(c,e.length).match(o)}return e};return c(c(e,!0),!1)},u=n(42),l=n(12),s=n(29),d=n(0),m=n(133),f=n.n(m),b=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=t.filter(Boolean);return r.length?0===r.length?r[0]:function(e){var t,n=Object(s.a)(r);try{for(n.s();!(t=n.n()).done;){var a=t.value;"function"===typeof a?a(e):a&&(a.current=e)}}catch(c){n.e(c)}finally{n.f()}}:null},p=function(){return window.location.hash.replace("#","")||"/"},h=function(){var e=d.useState(p()),t=Object(l.a)(e,2),n=t[0],r=t[1];d.useEffect((function(){var e=function(){return r(p())};return window.addEventListener("hashchange",e),function(){return window.removeEventListener("hashchange",e)}}),[]);var a=d.useCallback((function(e){return window.location.hash=e}),[]);return[n,a,a]},v=0,g=function(e){if("function"===typeof e){var t=e();t&&(document.title=t)}d.useEffect((function(){var t=document.title;return v++,"string"===typeof e&&(document.title=e),function(){return!v--&&(document.title=t)}}))},O=function(e,t){d.useEffect((function(){var n=setInterval(e,t);return function(){return clearInterval(n)}}),[e,t])},E=function(e,t,n){d.useEffect((function(){return e.addEventListener(t,n),function(){return e.removeEventListener(t,n)}}))},y=function(e){var t=e.shouldProtect,n=void 0===t||t;return d.useEffect((function(){return n&&(window.onbeforeunload=function(e){return"Are you sure you want to quit?"}),function(){return window.onbeforeunload=null}})),null},j=function(e){var t=e.children,n=e.show,r=Object(u.a)(e,["children","show"]);return d.createElement("div",Object.assign({style:n?{}:{display:"none"}},r),t)},w=function(e){var t=e.source,n=e.purify,r=void 0===n||n,a=Object(u.a)(e,["source","purify"]);return d.createElement("span",Object.assign({dangerouslySetInnerHTML:{__html:r?f.a.sanitize(t):t}},a))},x=n(149),k=n(239),C=n(240),T=n(241),S=null,_=function(){var e,t=(e=new Date,x.a(e,"yyyyMMdd-hhmmss")),n=t;return null!==S&&S.substring(0,t.length)===n&&(S.length===t.length?n+="-1":n+="-"+(parseInt(S.substring(t.length+1,S.length))+1)),S=n,n},D=function(e){var t=new Date(e),n=new Date,r=function(e){return 0===e.getHours()&&0===e.getMinutes()?null:0===e.getMinutes()?x.a(e,"haaa"):x.a(e,"h:mmaaa")}(t);return function(e){var t=k.a(e,n),r=C.a(e,n,{weekStartsOn:1}),a=T.a(e,n),c=n.getDay()-1;if(c<0&&(c+=7),0===t)return"Today";if(-1===t)return"Yesterday";if(1===t)return"Tomorrow";var i=x.a(e,"EEE");return 0===r&&t>=0||c>=5&&t>=0&&t<5?i:t>=-7&&t<0?"Last ".concat(i):t>0&&t<=7?"Next ".concat(i):t>7&&t<=14?"".concat(i," Week"):0===a?x.a(e,"EEE do MMM"):x.a(e,"EEE do MMM yyyy")}(t)+(r?" "+r:"")},N=function(e){var t=(e-(new Date).getTime())/1e3;return t<0?"urgency-overdue":t<7200?"urgency-two-hours":t<86400?"urgency-day":t<604800?"urgency-week":t<1209600?"urgency-fortnight":null},I=function(e,t){return Object.keys(e).reduce((function(n,r){return n[r]=t(e[r]),n}),{})},A=function(e,t){return Object.keys(e).length===Object.keys(t).length&&Object.keys(e).every((function(n){return e[n]===t[n]}))},L=function(e,t){var n=e.indexOf(t);return-1!==n&&e.splice(n,1),-1!==n},H=function(e){var t=window.history.state;window.history.replaceState(e,window.title);var n=window.history.state;return window.history.replaceState(t,window.title),n},R=function(e){return e&&"object"===typeof e&&!Array.isArray(e)};function M(e,t){if(R(e)&&R(t))for(var n in t)R(t[n])&&R(e[n])?M(e[n],t[n]):e[n]=t[n];return e}var z=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10,r=[],a=e.toLowerCase();for(var c in t)if(t[c].content.toLowerCase().includes(a)&&(r.push(c),r.length===n))return r;for(var i in t)if(t[i].description&&t[i].description.toLowerCase().includes(a)&&(r.push(i),r.length===n))return r;for(var o in t)if(o.toLowerCase().includes(a)&&(r.push(o),r.length===n))return r;return r};function B(e,t){return function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e,r=arguments.length>1?arguments[1]:void 0;if(Object.prototype.hasOwnProperty.call(t,r.type)){var a=t[r.type](n,r);return a||console.error("Invalid state produced by createReducer for ".concat(r.type,": ").concat(a)),a}}}},171:function(e,t,n){e.exports=n(205)},202:function(e,t,n){},203:function(e,t,n){},204:function(e,t,n){},205:function(e,t,n){"use strict";n.r(t);var r={};n.r(r),n.d(r,"Edit",(function(){return Qt})),n.d(r,"Indicator",(function(){return en}));var a={};n.r(a),n.d(a,"Edit",(function(){return mn})),n.d(a,"Indicator",(function(){return fn}));var c={};n.r(c),n.d(c,"Edit",(function(){return hn})),n.d(c,"Indicator",(function(){return On}));var i=n(0),o=n.n(i),u=n(21),l=n.n(u),s=n(12),d=n(13),m=n(19),f=n(36),b=n(15),p=n(8),h=n.n(p),v=n(17),g=n(22),O=n(38),E=n.n(O),y=n(23),j=n(10),w=n(134),x=n(29),k=n(25);function C(){return T.apply(this,arguments)}function T(){return(T=Object(v.a)(h.a.mark((function e(){var t,n,r,a=arguments;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=!(a.length>0&&void 0!==a[0])||a[0],n=function(){var e=Object(v.a)(h.a.mark((function e(){var t;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Be();case 2:return t=e.sent,e.next=5,I(t);case 5:return e.abrupt("return",t);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),e.next=4,Object(k.c)();case 4:if(e.sent.length){e.next=14;break}if(!(r=N())){e.next=11;break}return e.next=10,I(r);case 10:return e.abrupt("return",r);case 11:return e.next=13,n();case 13:return e.abrupt("return",e.sent);case 14:return e.prev=14,e.next=17,_(t);case 17:return e.abrupt("return",e.sent);case 20:return e.prev=20,e.t0=e.catch(14),console.error(e.t0),e.next=25,n();case 25:return e.abrupt("return",e.sent);case 26:case"end":return e.stop()}}),e,null,[[14,20]])})))).apply(this,arguments)}var S=function(){var e=Object(v.a)(h.a.mark((function e(t,n){var r,a,c,i,o,u,l=arguments;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=l.length>2&&void 0!==l[2]?l[2]:null,a=[],e.t0=x.a,e.next=5,Object(k.c)();case 5:e.t1=e.sent,c=(0,e.t0)(e.t1),e.prev=7,c.s();case 9:if((i=c.n()).done){e.next=18;break}if(o=i.value,(u=o.split("."))[1]!==n){e.next=16;break}if("continue"!==function(){var e=u[2];if(r&&-1===r.indexOf(e))return"continue";a.push(Object(k.b)(o).then((function(r){return t[n][e]=r})))}()){e.next=16;break}return e.abrupt("continue",16);case 16:e.next=9;break;case 18:e.next=23;break;case 20:e.prev=20,e.t2=e.catch(7),c.e(e.t2);case 23:return e.prev=23,c.f(),e.finish(23);case 26:return e.next=28,Promise.all(a);case 28:return e.abrupt("return",t);case 29:case"end":return e.stop()}}),e,null,[[7,20,23,26]])})));return function(t,n){return e.apply(this,arguments)}}();function _(){return D.apply(this,arguments)}function D(){return(D=Object(v.a)(h.a.mark((function e(){var t,n,r,a,c,i,o=arguments;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=!(o.length>0&&void 0!==o[0])||o[0],n={cards:{},columns:{},tabs:{}},r=Object(x.a)(_e),e.prev=3,r.s();case 5:if((a=r.n()).done){e.next=15;break}return c=a.value,e.next=9,Object(k.b)("mirror.".concat(c));case 9:if(e.t0=e.sent,e.t0){e.next=12;break}e.t0=[];case 12:n[c]=e.t0;case 13:e.next=5;break;case 15:e.next=20;break;case 17:e.prev=17,e.t1=e.catch(3),r.e(e.t1);case 20:return e.prev=20,r.f(),e.finish(20);case 23:return i=[S(n,"tabs"),S(n,"columns").then((function(){if(t)return S(n,"cards");var e=["main"];for(var r in n.columns)e.push.apply(e,Object(f.a)(n.columns[r].items));return S(n,"cards",e)}))],e.next=26,Promise.all(i);case 26:return e.abrupt("return",n);case 27:case"end":return e.stop()}}),e,null,[[3,17,20,23]])})))).apply(this,arguments)}function N(){try{if(Object.prototype.hasOwnProperty.call(localStorage,"kanban")){var e=JSON.parse(localStorage.kanban);return delete localStorage.kanban,e}}catch(t){return console.error(t),null}}function I(e){return A.apply(this,arguments)}function A(){return(A=Object(v.a)(h.a.mark((function e(t){var n,r,a,c,i,o,u,l;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,t&&!t.loading){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,Object(k.b)("mirror.starredZettels");case 5:if(e.t0=e.sent,null!=e.t0){e.next=9;break}return e.next=9,Object(k.d)("mirror.starredZettels",[]);case 9:n=Object(x.a)(_e),e.prev=10,n.s();case 12:if((r=n.n()).done){e.next=19;break}if(a=r.value,!Object.prototype.hasOwnProperty.call(t,a)){e.next=17;break}return e.next=17,Object(k.d)("mirror.".concat(a),t[a]);case 17:e.next=12;break;case 19:e.next=24;break;case 21:e.prev=21,e.t1=e.catch(10),n.e(e.t1);case 24:return e.prev=24,n.f(),e.finish(24);case 27:c=[],i=Object(x.a)(De);try{for(i.s();!(o=i.n()).done;)for(l in u=o.value,t[u])c.push(Object(k.d)("mirror.".concat(u,".").concat(l),t[u][l]))}catch(s){i.e(s)}finally{i.f()}return e.next=32,Promise.all(c);case 32:return e.abrupt("return",e.sent);case 35:e.prev=35,e.t2=e.catch(0),console.error(e.t2);case 38:case"end":return e.stop()}}),e,null,[[0,35],[10,21,24,27]])})))).apply(this,arguments)}function L(e){return H.apply(this,arguments)}function H(){return(H=Object(v.a)(h.a.mark((function e(t){var n,r=arguments;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=r.length>1&&void 0!==r[1]?r[1]:null,e.prev=1,n){e.next=8;break}return e.next=5,Object(k.b)("mirror."+t);case 5:return e.abrupt("return",e.sent);case 8:return e.next=10,Object(k.b)("mirror."+t+"."+n);case 10:return e.abrupt("return",e.sent);case 11:e.next=16;break;case 13:return e.prev=13,e.t0=e.catch(1),e.abrupt("return",null);case 16:case"end":return e.stop()}}),e,null,[[1,13]])})))).apply(this,arguments)}function R(e){return M.apply(this,arguments)}function M(){return(M=Object(v.a)(h.a.mark((function e(t){var n,r,a,c;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=[],r=Object(x.a)(t.set),e.prev=2,r.s();case 4:if((a=r.n()).done){e.next=17;break}c=a.value,e.t0=c.type,e.next="add"===e.t0||"edit"===e.t0?9:"delete"===e.t0?11:"param"===e.t0?13:15;break;case 9:return n.push(Object(k.d)("mirror.".concat(c.namespace,".").concat(c.object.id),c.object)),e.abrupt("break",15);case 11:return n.push(Object(k.a)("mirror.".concat(c.namespace,".").concat(c.id))),e.abrupt("break",15);case 13:return n.push(Object(k.d)("mirror.".concat(c.namespace),c.value)),e.abrupt("break",15);case 15:e.next=4;break;case 17:e.next=22;break;case 19:e.prev=19,e.t1=e.catch(2),r.e(e.t1);case 22:return e.prev=22,r.f(),e.finish(22);case 25:return e.next=27,Promise.all(n);case 27:return e.abrupt("return",e.sent);case 28:case"end":return e.stop()}}),e,null,[[2,19,22,25]])})))).apply(this,arguments)}window.deleteAllState=Object(v.a)(h.a.mark((function e(){var t,n,r;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=Promise,e.next=3,Object(k.c)();case 3:return e.t1=e.sent.map((function(e){return Object(k.a)(e)})),e.next=6,e.t0.all.call(e.t0,e.t1);case 6:for(t=e.sent,n=localStorage.length-1;n>=0;n--)(r=localStorage.key(n)).startsWith("__GITHUB")&&delete localStorage[r];return e.abrupt("return",t);case 9:case"end":return e.stop()}}),e)}))),window.__idb={get:k.b,set:k.d,keys:k.c,del:k.a},window.__idb.getAll=Object(v.a)(h.a.mark((function e(){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=Promise,e.next=3,window.__idb.keys();case 3:return e.t1=e.sent.map(function(){var e=Object(v.a)(h.a.mark((function e(t){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=t,e.next=3,window.__idb.get(t);case 3:return e.t1=e.sent,e.abrupt("return",[e.t0,e.t1]);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.abrupt("return",e.t0.all.call(e.t0,e.t1));case 5:case"end":return e.stop()}}),e)})));var z=null,B=function(){var e=Object(v.a)(h.a.mark((function e(){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!z){e.next=2;break}return e.abrupt("return",z);case 2:return e.next=4,n.e(3).then(n.bind(null,287)).then((function(e){return new(0,e.Octokit)({auth:G.token})}));case 4:return e.abrupt("return",z=e.sent);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),G={sha:{get latest(){return localStorage.__GITHUB_GIST_LATEST_SHA},set latest(e){localStorage.__GITHUB_GIST_LATEST_SHA=e},get current(){return localStorage.__GITHUB_GIST_CURRENT_SHA},set current(e){localStorage.__GITHUB_GIST_CURRENT_SHA=e}},get token(){return localStorage.__GITHUB_TOKEN},set token(e){localStorage.__GITHUB_TOKEN=e},get username(){return localStorage.__GITHUB_USERNAME},set username(e){localStorage.__GITHUB_USERNAME=e},get gist_id(){return localStorage.__GITHUB_GIST_ID},set gist_id(e){localStorage.__GITHUB_GIST_ID=e}};function P(){return Boolean(G.token)}function U(e){return Z.apply(this,arguments)}function Z(){return(Z=Object(v.a)(h.a.mark((function e(t){var n,r;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==t.set.length){e.next=2;break}return e.abrupt("return",[]);case 2:return e.next=4,B();case 4:return n=e.sent,r=function(e){return n.request("PATCH /gists/{gist_id}",{gist_id:G.gist_id,description:"Mirror synchronisation (https://oliverbalfour.github.io/Mirror/)",files:F(e)})},e.next=8,r(t).catch(function(){var e=Object(v.a)(h.a.mark((function e(n){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.error(n),e.next=3,Promise.all(t.set.map((function(e){return r({set:[e]})}))).catch(console.error);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 8:return e.next=10,le().catch((function(e){console.error("Commit of changes failed. State may no longer be reflected by online sync target. Error: ".concat(e.toString()))}));case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function F(e){var t,n={},r=Object(x.a)(e.set);try{for(r.s();!(t=r.n()).done;){var a=t.value,c=W(a);switch(a.type){case"delete":n[c]=null;break;case"add":case"edit":var i=$(a.object);n[c]={filename:c,content:i};break;case"param":n[c]={filename:c,content:JSON.stringify(a.value)}}}}catch(o){r.e(o)}finally{r.f()}return n}function W(e){return V(e.namespace,e.object?e.object.id:null)}function V(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return"cards"===e?"".concat(t,".md"):t?"".concat(e,".").concat(t,".md"):"".concat(e,".md")}function J(e){var t=e.split(".");return 2===t.length?-1===_e.indexOf(t[0])?["cards",t[0]]:[t[0]]:[t[0],t[1]]}function $(e){var t=["description"],n=[];for(var r in e)if(-1===t.indexOf(r)){var a="time"===r?new Date(e[r]).getTime():JSON.stringify(e[r]);n.push("".concat(r,": ").concat(a))}var c="---\n".concat(n.join("\n"),"\n---\n");return e.description&&(c+=e.description),c}function K(e){var t={},n=e.split("---"),r=Object(s.a)(n,3),a=r[0],c=r[1],i=r[2];return c?(c.split("\n").filter((function(e){return e.trim().length})).forEach((function(e){var n=e.split(":"),r=Object(w.a)(n),a=r[0],c=r.slice(1).join(":");t[a]=JSON.parse(c.trimStart())})),i.trim().length&&(t.description=i.trim()),t):JSON.parse(a)}function q(){return(q=Object(v.a)(h.a.mark((function e(){var t,n;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,oe();case 2:return G.sha.latest=e.sent,e.next=5,te("__logged_in",!1);case 5:if(e.t0=e.sent.status,t=404!==e.t0,console.log("Logging in. Has "+(t?"":"not ")+"logged in before."),n={},!t){e.next=16;break}return e.next=12,Q();case 12:n=e.sent,console.log("Finished loading and caching remote state."),e.next=25;break;case 16:return e.next=18,re("__logged_in","true");case 18:return e.t1=ee,e.next=21,C();case 21:return e.t2=e.sent,e.next=24,(0,e.t1)(e.t2);case 24:console.log("Finished writing local state to remote.");case 25:return e.abrupt("return",n);case 26:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Y=function(){var e=Object(v.a)(h.a.mark((function e(){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("PUSH"===window.prompt('Force push to GitHub? This will reversibly OVERWRITE REMOTE STATE.Only use if corrupted. Enter "PUSH" to continue')){e.next=2;break}return e.abrupt("return");case 2:return e.t0=ee,e.next=5,C();case 5:return e.t1=e.sent,e.next=8,(0,e.t0)(e.t1);case 8:console.log("Finished force pushing local state to remote.");case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),X=function(){var e=Object(v.a)(h.a.mark((function e(){var t,n,r;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("PULL"===window.prompt('Force pull from GitHub? This will IRREVERSIBLY OVERWRITE LOCAL STATE.Only use if corrupted. Enter "PULL" to continue')){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,de(null);case 4:return t=e.sent,e.next=7,pe(t);case 7:return n=e.sent,r=ve(n),e.next=11,I(r);case 11:G.sha.current=G.sha.latest=t[0],console.log("Reset local state to ".concat(G.sha.current.substring(0,10))),window.location.reload();case 14:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Q=function(){var e=Object(v.a)(h.a.mark((function e(){var t,n;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,oe();case 3:if(G.sha.latest=e.sent,G.sha.latest!==G.sha.current){e.next=7;break}return console.log("No state updates required"),e.abrupt("return",{});case 7:return e.next=9,pe();case 9:return t=e.sent,n=ve(t),e.next=13,I(n);case 13:return console.log("Updated local state: ".concat((G.sha.current||"none").substring(0,10),"..").concat(G.sha.latest.substring(0,10))),G.sha.current=G.sha.latest,e.abrupt("return",n);case 18:e.prev=18,e.t0=e.catch(0),console.log("Error occurred while synchronising state. Check network connection. Error: ".concat(e.t0.toString()));case 21:case"end":return e.stop()}}),e,null,[[0,18]])})));return function(){return e.apply(this,arguments)}}(),ee=function(){var e=Object(v.a)(h.a.mark((function e(t){var n,r,a,c,i,o,u,l;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=new ye,r=Object(x.a)(_e);try{for(r.s();!(a=r.n()).done;)c=a.value,n.param(c,t[c],null)}catch(s){r.e(s)}finally{r.f()}i=Object(x.a)(De);try{for(i.s();!(o=i.n()).done;)for(l in u=o.value,t[u])n.add(u,t[u][l])}catch(s){i.e(s)}finally{i.f()}U(n);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();function te(e){return ne.apply(this,arguments)}function ne(){return(ne=Object(v.a)(h.a.mark((function e(t){var n,r,a,c=arguments;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=!(c.length>1&&void 0!==c[1])||c[1],r="https://gist.githubusercontent.com/"+"".concat(G.username,"/").concat(G.gist_id,"/raw/").concat(G.sha.latest,"/").concat(t),e.next=4,fetch(r);case 4:if(a=e.sent,!n){e.next=9;break}return e.abrupt("return",K(a.text()));case 9:return e.abrupt("return",a);case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function re(e,t){return ae.apply(this,arguments)}function ae(){return(ae=Object(v.a)(h.a.mark((function e(t,n){var r,a;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return 0===n.length&&(n="null"),r=Object(m.a)({},t,{filename:t,content:n}),e.next=4,B();case 4:return a=e.sent,e.next=7,a.request("PATCH /gists/{gist_id}",{gist_id:G.gist_id,files:r});case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ce(e){return ie.apply(this,arguments)}function ie(){return(ie=Object(v.a)(h.a.mark((function e(t){var n,r=arguments;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.length>1&&void 0!==r[1]?r[1]:null,e.prev=1,e.next=4,te(V(t,n));case 4:return e.abrupt("return",e.sent);case 7:return e.prev=7,e.t0=e.catch(1),e.abrupt("return",null);case 10:case"end":return e.stop()}}),e,null,[[1,7]])})))).apply(this,arguments)}function oe(){return ue.apply(this,arguments)}function ue(){return(ue=Object(v.a)(h.a.mark((function e(){var t,n;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,B();case 2:return t=e.sent,e.next=5,t.request("GET /gists/{gist_id}/commits",{gist_id:G.gist_id,per_page:1});case 5:return n=e.sent,e.abrupt("return",n.data[0].version);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function le(){return se.apply(this,arguments)}function se(){return(se=Object(v.a)(h.a.mark((function e(){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,oe();case 2:G.sha.current=G.sha.latest=e.sent;case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function de(){return me.apply(this,arguments)}function me(){return(me=Object(v.a)(h.a.mark((function e(){var t,n,r,a,c,i,o,u,l,s=arguments;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=s.length>0&&void 0!==s[0]?s[0]:G.sha.current,e.next=3,B();case 3:n=e.sent,r=[],a=1;case 6:if(!(a<100)){e.next=34;break}return e.next=9,n.request("GET /gists/{gist_id}/commits",{gist_id:G.gist_id,per_page:100,page:a});case 9:if(0!==(c=e.sent.data).length){e.next=12;break}return e.abrupt("break",34);case 12:i=Object(x.a)(c),e.prev=13,i.s();case 15:if((o=i.n()).done){e.next=23;break}if(u=o.value,l=u.version,t!==l){e.next=20;break}return e.abrupt("break",23);case 20:r.push(l);case 21:e.next=15;break;case 23:e.next=28;break;case 25:e.prev=25,e.t0=e.catch(13),i.e(e.t0);case 28:return e.prev=28,i.f(),e.finish(28);case 31:a++,e.next=6;break;case 34:return e.abrupt("return",r);case 35:case"end":return e.stop()}}),e,null,[[13,25,28,31]])})))).apply(this,arguments)}function fe(e){return be.apply(this,arguments)}function be(){return(be=Object(v.a)(h.a.mark((function e(t){var n,r;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,B();case 2:return n=e.sent,e.next=5,n.request("GET /gists/{gist_id}/{sha}",{gist_id:G.gist_id,sha:t});case 5:return r=e.sent,e.abrupt("return",r.data.files);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function pe(){return he.apply(this,arguments)}function he(){return(he=Object(v.a)(h.a.mark((function e(){var t,n,r,a,c,i,o,u,l=arguments;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=l.length>0&&void 0!==l[0]?l[0]:null){e.next=5;break}return e.next=4,de();case 4:t=e.sent;case 5:for(n={},r=[],a=0;a<t.length;a++)r.push(fe(t[a]));return e.next=10,Promise.all(r);case 10:c=e.sent,i=t.length;case 12:if(!(i-- >0)){e.next=24;break}o=c[i],e.t0=h.a.keys(o);case 15:if((e.t1=e.t0()).done){e.next=22;break}if("__logged_in"!==(u=e.t1.value)){e.next=19;break}return e.abrupt("continue",15);case 19:n[u]=o[u].content,e.next=15;break;case 22:e.next=12;break;case 24:return e.abrupt("return",n);case 25:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ve(e){var t={};for(var n in e){var r=void 0;try{r=K(e[n])}catch(l){continue}var a,c=J(n),i=t,o=Object(x.a)(c.slice(0,-1));try{for(o.s();!(a=o.n()).done;){var u=a.value;i[u]=i[u]||{},i=i[u]}}catch(s){o.e(s)}finally{o.f()}i[c[c.length-1]]=r}return t}function ge(){if(window.confirm("Are you sure you want to log out? All your state will be saved locally and on GitHub, but it will no longer synchronise.")){for(var e=localStorage.length-1;e>=0;e--){var t=localStorage.key(e);t.startsWith("__GITHUB")&&delete localStorage[t]}window.location.reload()}}var Oe=n(86),Ee=n(89),ye=function(){function e(){Object(Oe.a)(this,e),this.set=[],this.inv=[]}return Object(Ee.a)(e,[{key:"add",value:function(e,t){return this.set.push({type:"add",namespace:e,object:t}),this.inv.push({type:"delete",namespace:e,id:t.id}),this}},{key:"edit",value:function(e,t,n){return this.set.push({type:"edit",namespace:e,object:t}),this.inv.push({type:"edit",namespace:e,object:n}),this}},{key:"delete",value:function(e,t,n){return this.set.push({type:"delete",namespace:e,id:t}),this.inv.push({type:"add",namespace:e,object:n}),this}},{key:"param",value:function(e,t,n){return this.set.push({type:"param",namespace:e,value:t}),this.inv.push({type:"param",namespace:e,value:n}),this}},{key:"concat",value:function(e){for(var t,n,r=e.inv.length-1;r>=0;r--)for(var a=this.set.length-1;a>=0;a--)Object(j.p)(e.inv[r],this.set[a])&&(e.inv.splice(r,1),e.set.splice(r,1),this.inv.splice(a,1),this.set.splice(a,1));(t=this.set).push.apply(t,Object(f.a)(e.set)),(n=this.inv).push.apply(n,Object(f.a)(e.inv));for(var c=[],i=this.set.length-1;i>=0;i--){var o=je(this.set[i]);-1!==c.indexOf(o)?this.set.splice(i,1):c.push(o)}return this}},{key:"concatSimple",value:function(e){var t,n;return(t=this.set).push.apply(t,Object(f.a)(e.set)),(n=this.inv).push.apply(n,Object(f.a)(e.inv)),this}},{key:"editAll",value:function(e,t,n){for(var r in t)this.edit(e,t[r],n[r]);return this}},{key:"editAllByID",value:function(e,t,n,r){var a,c=Object(x.a)(n);try{for(c.s();!(a=c.n()).done;){var i=a.value;this.edit(e,t[i],r[i])}}catch(o){c.e(o)}finally{c.f()}return this}},{key:"deleteAllByID",value:function(e,t,n){var r,a=Object(x.a)(t);try{for(a.s();!(r=a.n()).done;){var c=r.value;this.delete(e,c,n[c])}}catch(i){a.e(i)}finally{a.f()}return this}},{key:"invert",value:function(){var t=new e;return t.set=this.inv,t.inv=this.set,t}}]),e}(),je=function(e){switch(e.type){case"add":case"edit":return e.object.id;case"delete":return e.id;case"param":return e.namespace}};ye.prototype.commit=function(){ze(this),we.editSetHistory.past.push(this),we.editSetHistory.past.length>20&&we.editSetHistory.past.shift(),we.editSetHistory.future=[]};var we={editSetHistory:{past:[],future:[]},undo:{allowed:function(){return we.editSetHistory.past.length>0},commit:function(){var e=we.editSetHistory.past.pop();we.editSetHistory.future.unshift(e),we.editSetHistory.future.length>20&&we.editSetHistory.future.pop(),ze(e.invert())}},redo:{allowed:function(){return we.editSetHistory.future.length>0},commit:function(){var e=we.editSetHistory.future.shift();we.editSetHistory.past.push(e),we.editSetHistory.past.length>20&&we.editSetHistory.past.shift(),ze(e)}}},xe="cards",ke="columns",Ce="tabs",Te="tabOrder",Se="starredZettels",_e=["tabOrder","starredZettels"],De=["cards","columns","tabs"];function Ne(){return(Ne=Object(v.a)(h.a.mark((function e(){var t,n,r=arguments;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=!(r.length>0&&void 0!==r[0])||r[0],e.next=3,C(t);case 3:if(n=e.sent,!P()){e.next=11;break}return e.t0=b.a,e.t1=Object(b.a)({},n),e.next=9,Q();case 9:e.t2=e.sent,n=(0,e.t0)(e.t1,e.t2);case 11:return e.abrupt("return",n);case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ie(e){return Ae.apply(this,arguments)}function Ae(){return(Ae=Object(v.a)(h.a.mark((function e(t){var n,r,a=arguments;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.length>1&&void 0!==a[1]?a[1]:null,e.next=3,L(t,n);case 3:if(!(r=e.sent)){e.next=6;break}return e.abrupt("return",r);case 6:return e.abrupt("return",ce(t,n));case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Le,He=new ye,Re=null,Me=[],ze=function(e){return new Promise((function(t,n){var r=[R(e)];P()?Re?(He.concat(e),Me.push(t)):(r.push(U(e)),Re=setTimeout((function(){U(He),Re=null,He=new ye,Me.forEach((function(e){return e()})),Me=[]}),5e3),Promise.all(r).then(t)):Promise.all(r).then(t)}))},Be=function(){return fetch("./initial-state.json").then((function(e){return e.json()})).catch((function(e){return alert("Could not load initial state. Perhaps you forgot a trailing slash in the URL? Error: "+e)}))},Ge=Object(g.b)("mirror/SET_STATE"),Pe=Object(g.b)("mirror/OVERWRITE_STATE"),Ue=Object(g.b)("kanban/TRANSFER_CARD"),Ze=Object(g.b)("kanban/REORDER_CARD"),Fe=Object(g.b)("kanban/ADD_CARD"),We=Object(g.b)("kanban/EDIT_CARD_CONTENT"),Ve=Object(g.b)("kanban/EDIT_CARD"),Je=Object(g.b)("kanban/DELETE_CARD"),$e=Object(g.b)("kanban/ADD_COLUMN"),Ke=Object(g.b)("kanban/DELETE_COLUMN"),qe=Object(g.b)("kanban/RENAME_COLUMN"),Ye=Object(g.b)("kanban/MOVE_COLUMN"),Xe=Object(g.b)("kanban/ARCHIVE_ALL_COLUMN"),Qe=Object(g.b)("kanban/SORT_COLUMN_BY_CARD_TIME_ATTRIBUTE"),et=Object(g.b)("kanban/ADD_TAB"),tt=Object(g.b)("kanban/DELETE_TAB"),nt=Object(g.b)("kanban/RENAME_TAB"),rt=Object(g.b)("kanban/MOVE_TAB"),at=Object(g.b)("zettelkasten/ADD_ZETTEL"),ct=Object(g.b)("zettelkasten/EDIT_ZETTEL"),it=Object(g.b)("zettelkasten/DELETE_ZETTEL"),ot=Object(g.b)("zettelkasten/TOGGLE_STARRED"),ut=Object(g.c)("zettelkasten/LOAD_ZETTEL",function(){var e=Object(v.a)(h.a.mark((function e(t,n){var r;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ie("cards",t);case 2:if(r=e.sent){e.next=7;break}return e.abrupt("return",n.rejectWithValue(t));case 7:return e.abrupt("return",r);case 8:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),lt={getColumnsInTabs:function(e){return Object(j.k)(e.tabs,(function(t){return t.columns.map((function(t){return e.columns[t]})).map((function(t){return Object(b.a)(Object(b.a)({},t),{},{items:t.items.map((function(t){return e.cards[t]}))})}))}))},columns:function(e){return e.columns},tabs:function(e){return e.tabs},tabOrder:function(e){return e.tabOrder},cards:function(e){return e.cards},archivedCards:function(e){return Object.values(e.cards).filter((function(e){return-1!==Object.keys(e).indexOf("archived")}))},activeCards:function(e){return Object.values(e.cards).filter((function(e){return-1===Object.keys(e).indexOf("archived")}))},starredZettels:function(e){return e.starredZettels?e.starredZettels:[]},cardsByTab:function(e){return Object(j.k)(e.tabs,(function(t){return t.columns.flatMap((function(t){return e.columns[t].items}))}))},loadingZettel:function(e){return e.loadingZettel}},st=Object(j.e)({loading:!0},(Le={},Object(m.a)(Le,Ge,(function(e,t){return t.payload})),Object(m.a)(Le,Pe,(function(e,t){if("{}"===JSON.stringify(t.payload))return e;var n=Object(j.q)(e);return Object(j.f)(n,t.payload),n})),Object(m.a)(Le,O.ActionTypes.UNDO,(function(e,t){return we.undo.commit(),e})),Object(m.a)(Le,O.ActionTypes.REDO,(function(e,t){return we.redo.commit(),e})),Object(m.a)(Le,Ue,(function(e,t){var n=(new Date).getTime(),r=t.payload,a=r.srcColID,c=r.dstColID,i=r.srcIndex,o=r.dstIndex;if(a===c&&i===o)return e;var u=e.columns[a].items[i],l=Object(y.a)(e,(function(e){e.columns[a].items.splice(i,1),e.cards[u].moved=n,e.columns[a].edited=n,e.columns[c].edited=n,e.columns[c].items.splice(o,0,u)}));return(new ye).edit(xe,l.cards[u],e.cards[u]).edit(ke,l.columns[a],e.columns[a]).edit(ke,l.columns[c],e.columns[c]).commit(),l})),Object(m.a)(Le,Ze,(function(e,t){var n=t.payload,r=n.colID,a=n.srcIndex,c=n.dstIndex;if(a===c)return e;var i=(new Date).getTime(),o=e.columns[r].items[a],u=Object(y.a)(e,(function(e){e.columns[r].edited=i,e.columns[r].items.splice(a,1),e.cards[o].moved=i,e.columns[r].items.splice(c,0,o)}));return(new ye).edit(ke,u.columns[r],e.columns[r]).edit(xe,u.cards[o],e.cards[o]).commit(),u})),Object(m.a)(Le,Fe,(function(e,t){var n=t.payload,r=n.content,a=n.colID,c=Object(j.h)(),i=(new Date).getTime(),o={id:c,content:r,type:0,created:i,edited:i,moved:i},u=Object(y.a)(e,(function(e){e.cards[c]=o,e.columns[a].items.unshift(c),e.columns[a].edited=i}));return(new ye).add(xe,o).edit(ke,u.columns[a],e.columns[a]).commit(),u})),Object(m.a)(Le,Ke,(function(e,t){var n=t.payload,r=(new Date).getTime(),a=e.tabOrder.map((function(t){return-1!==e.tabs[t].columns.indexOf(n)})).indexOf(!0),c=Object(y.a)(e,(function(e){a>=0&&(e.tabs[e.tabOrder[a]].edited=r),e.columns[n].items.forEach((function(t){return delete e.cards[t]})),Object.values(e.tabs).forEach((function(e){return Object(j.g)(e.columns,n)})),delete e.columns[n]}));return(new ye).editAll(Ce,c.tabs,e.tabs).deleteAllByID(xe,e.columns[n].items,e.cards).commit(),c})),Object(m.a)(Le,qe,(function(e,t){var n=t.payload,r=n.colID,a=n.name;if(e.columns[r].name===a)return e;var c=Object(y.a)(e,(function(e){e.columns[r].name=a,e.columns[r].edited=(new Date).getTime()}));return(new ye).edit(ke,c.columns[r],e.columns[r]).commit(),c})),Object(m.a)(Le,We,(function(e,t){var n=t.payload,r=n.cardID,a=n.content;if(e.cards[r].content===a)return e;var c=Object(y.a)(e,(function(e){e.cards[r].content=a,e.cards[r].edited=(new Date).getTime()}));return(new ye).edit(xe,c.cards[r],e.cards[r]).commit(),c})),Object(m.a)(Le,Je,(function(e,t){var n=t.payload,r=(new Date).getTime(),a=[],c=Object(y.a)(e,(function(e){Object.values(e.columns).forEach((function(e){Object(j.g)(e.items,n)&&(e.edited=r,a.push(e.id))})),delete e.cards[t.payload]}));return(new ye).delete(xe,n,e.cards[n]).editAllByID(ke,c.columns,a,e.columns).commit(),c})),Object(m.a)(Le,$e,(function(e,t){var n=t.payload,r=n.tabID,a=n.name,c=Object(j.h)(),i=(new Date).getTime(),o={id:c,items:[],name:a,created:i,edited:i},u=Object(y.a)(e,(function(e){e.columns[c]=o,e.tabs[r].columns.push(c),e.tabs[r].edited=i}));return(new ye).add(ke,o).edit(Ce,u.tabs[r],e.tabs[r]).commit(),u})),Object(m.a)(Le,Ve,(function(e,t){var n=t.payload,r=n.card,a=n.colID;if(Object(j.p)(e.cards[r.id],r))return e;var c=(new Date).getTime(),i=Object.keys(e.columns).filter((function(t){return-1!==e.columns[t].items.indexOf(r.id)}))[0],o=Object(y.a)(e,(function(e){e.cards[r.id]=JSON.parse(JSON.stringify(t.payload.card)),e.cards[r.id].edited=c,i!==a&&(Object(j.g)(e.columns[i].items,r.id),e.columns[a].items.unshift(r.id),e.columns[i].edited=e.columns[a].edited=c)}));return(new ye).edit(xe,o.cards[r.id],e.cards[r.id]).concatSimple(function(){var t=new ye;return i!==a&&(t.edit(ke,o.columns[i],e.columns[i]),t.edit(ke,o.columns[a],e.columns[a])),t}()).commit(),o})),Object(m.a)(Le,tt,(function(e,t){var n=t.payload,r=[],a=e.tabOrder[n],c=Object(y.a)(e,(function(e){for(var t=e.tabs[a];t.columns.length;){var c=t.columns[0];r.push.apply(r,Object(f.a)(e.columns[c].items)),e.columns[c].items.forEach((function(t){return delete e.cards[t]})),delete e.columns[c],t.columns.shift()}delete e.tabs[t.id],e.tabOrder.splice(n,1)})),i=e.tabs[a];return(new ye).deleteAllByID(xe,r,e.cards).deleteAllByID(ke,i.columns,e.columns).delete(Ce,a,i).param(Te,c.tabOrder,e.tabOrder).commit(),c})),Object(m.a)(Le,et,(function(e,t){var n=Object(j.h)(),r={name:t.payload,id:n,columns:[],created:(new Date).getTime()},a=Object(y.a)(e,(function(e){e.tabs[n]=r,e.tabOrder.push(n)}));return(new ye).add(Ce,r).param(Te,a.tabOrder,e.tabOrder).commit(),a})),Object(m.a)(Le,nt,(function(e,t){var n=t.payload,r=n.tabID,a=n.name;if(e.tabs[r].namd===a)return e;var c=Object(y.a)(e,(function(e){e.tabs[r].name=a,e.tabs[r].edited=(new Date).getTime()}));return(new ye).edit(Ce,c.tabs[r],e.tabs[r]).commit(),c})),Object(m.a)(Le,Ye,(function(e,t){var n=Object(s.a)(t.payload,3),r=n[0],a=n[1],c=n[2];if(r===a)return e;var i=e.tabOrder[c],o=e.tabs[i].columns[r],u=Object(y.a)(e,(function(e){e.tabs[i].columns.splice(r,1),e.tabs[i].columns.splice(a,0,o),e.tabs[i].edited=(new Date).getTime()}));return(new ye).edit(Ce,u.tabs[i],e.tabs[i]).commit(),u})),Object(m.a)(Le,rt,(function(e,t){var n=Object(s.a)(t.payload,2),r=n[0],a=n[1];if(r===a)return e;var c=e.tabOrder[r];if(a<0||a>=e.tabs.length)return e;var i=Object(y.a)(e,(function(e){e.tabOrder.splice(r,1),e.tabOrder.splice(a,0,c)}));return(new ye).param(Te,i.tabOrder,e.tabOrder).commit(),i})),Object(m.a)(Le,Xe,(function(e,t){var n=t.payload;if(0===e.columns[n].items.length)return e;var r=(new Date).getTime(),a=Object(y.a)(e,(function(e){e.columns[n].items.forEach((function(t){var a=e.cards[t];a.moved=a.edited=a.archived=r,a.archivedFromColID=n})),e.columns[n].items=[],e.columns[n].edited=r}));return(new ye).editAllByID(xe,a.cards,e.columns[n].items,e.cards).edit(ke,a.columns[n],e.columns[n]).commit(),a})),Object(m.a)(Le,at,(function(e,t){var n=t.payload.zettel,r=n.id||Object(j.h)(),a=(new Date).getTime(),c=Object(b.a)({id:r,type:1,created:a,edited:a,moved:a},n),i=Object(y.a)(e,(function(e){e.cards[i]=c}));return(new ye).add(xe,c).commit(),i})),Object(m.a)(Le,ct,(function(e,t){var n=t.payload.zettel;if(Object(j.p)(e.cards[n.id],n))return e;var r=(new Date).getTime();if(-1===Object.keys(e.cards).indexOf(n.id))return e;var a=Object(y.a)(e,(function(e){e.cards[n.id]=n,e.cards[n.id].edited=r}));return(new ye).edit(xe,n,e.cards[n.id]).commit(),a})),Object(m.a)(Le,it,(function(e,t){var n=t.payload,r=Object(y.a)(e,(function(e){Object(j.g)(e.starredZettels,t.payload),delete e.cards[n]}));return new ye.param(Se,r.starredZettels,e.starredZettels).delete(xe,n,e.cards[n]).commit(),r})),Object(m.a)(Le,ot,(function(e,t){var n=t.payload,r=Object(y.a)(e,(function(e){e.starredZettels||(e.starredZettels=[]),-1===e.starredZettels.indexOf(n)?e.starredZettels.push(n):Object(j.g)(e.starredZettels,n)}));return(new ye).param(Se,r.starredZettels,e.starredZettels).commit(),r})),Object(m.a)(Le,Qe,(function(e,t){var n=t.payload,r=Object(y.a)(e,(function(e){e.columns[n].items.sort((function(t,n){var r=new Date(e.cards[n].time||null).getTime(),a=new Date(e.cards[t].time||null).getTime();return 0===a&&0===r?0:0===a?1:0===r?-1:a-r}))}));return(new ye).edit(ke,r.columns[n],e.columns[n]).commit(),r})),Object(m.a)(Le,ut.pending,(function(e,t){return Object(y.a)(e,(function(e){return e.loadingZettel=!0}))})),Object(m.a)(Le,ut.fulfilled,(function(e,t){return Object(y.a)(e,(function(e){e.cards[t.payload.id]=t.payload,delete e.loadingZettel}))})),Object(m.a)(Le,ut.rejected,(function(e,t){return Object(y.a)(e,(function(e){return e.loadingZettel=t.payload}))})),Le)),dt=[Ge.type,ut.pending.type,ut.fulfilled.type,ut.rejected.type],mt=E()(st,{limit:20,neverSkipReducer:!0,filter:function(e,t,n){return-1===dt.indexOf(e.type)}}),ft=n(245),bt=n(261),pt=n(246),ht=n(247),vt=n(69),gt=n.n(vt),Ot=n(150),Et=n(267),yt=function(e){var t=e.map,n=e.children,r=i.useState(null),a=Object(s.a)(r,2),c=a[0],o=a[1],u=function(){return o(null)};return i.createElement(i.Fragment,null,i.createElement(Ot.a,{anchorEl:c,keepMounted:!0,open:Boolean(c),onClose:u},Object.entries(t).map((function(e){var t=Object(s.a)(e,2),n=t[0],r=t[1];return i.createElement(Et.a,{key:n,onClick:function(){u(),r()}},n)}))),i.cloneElement(n,{onClick:function(e){return o(e.currentTarget)}}))},jt=function(e){var t=e.tabs,n=e.render,r=e.index,a=e.setIndex,c=e.addTab,o=e.renameTab,u=e.deleteTab,l=e.moveTab,s=e.toggleAddColumn,d=function(e,n){return n>=0&&n<t.length&&a(n)},m=function(){return i.createElement("div",{style:{flexGrow:1}})};return i.createElement("div",{className:"tab-bar-root"},i.createElement(ft.a,{className:"tab-bar-header",position:"static",style:{backgroundColor:"white",zIndex:2,position:"relative"}},i.createElement(bt.a,{value:r,onChange:d,indicatorColor:"primary",textColor:"primary"},t.map((function(e){return i.createElement(pt.a,{label:e,key:e})})),i.createElement(m,null),i.createElement(yt,{map:{"Add tab":function(){return c()},"Rename tab":function(){return o(r)},"Delete tab":function(){return u(r)},"Move tab left":function(){l([r,r-1]),d(0,r-1)},"Move tab right":function(){l([r,r+1]),d(0,r+1)},"Toggle add column view":function(){return s()}}},i.createElement(ht.a,null,i.createElement(gt.a,null))))),t.map((function(e,t){return r===t&&i.createElement("div",{className:"tab-bar-content",key:t},n(t))})))},wt=n(249),xt=n(141),kt=n.n(xt),Ct=n(103),Tt=n.n(Ct),St=n(265),_t=n(255),Dt=n(252),Nt=n(256),It=n(253),At=n(207),Lt=n(264),Ht=n(268),Rt=n(262),Mt=n(257),zt=n(83),Bt=Object(g.a)({reducer:function(e,t){return(t.type!==O.ActionTypes.UNDO||we.undo.allowed())&&(t.type!==O.ActionTypes.REDO||we.redo.allowed())?-1!==dt.indexOf(t.type)?Object(b.a)(Object(b.a)({},e),{},{present:st(e.present,t)}):mt(e,t):e},middleware:[zt.a]});(function(){return Ne.apply(this,arguments)})(!0).then((function(e){Bt.dispatch(Ge(e))}));try{document.addEventListener("keyup",(function(e){-1===["input","textarea"].indexOf(document.activeElement.tagName.toLowerCase())&&(e.ctrlKey&&90===e.which&&!e.shiftKey?Bt.dispatch(O.ActionCreators.undo()):(e.ctrlKey&&e.shiftKey&&90===e.which||e.ctrlKey&&89===e.which)&&Bt.dispatch(O.ActionCreators.redo()))}))}catch(lr){}var Gt=Bt,Pt=function(e){return e.present},Ut={boards:Object(j.k)(lt,(function(e){return function(t){return e(Pt(t))}}))},Zt=n(270),Ft=n(90),Wt=i.lazy((function(){return Promise.all([n.e(5),n.e(6)]).then(n.bind(null,286))})),Vt=function(e){var t=e.cards?Object(j.m)(e.source,e.cards):e.source;return-1===t.indexOf("$$")?i.createElement(Ft.a,Object.assign({},e,{source:t})):i.createElement(i.Suspense,{fallback:i.createElement("span",null,"Loading...")},i.createElement(Wt,Object.assign({},e,{source:t})))},Jt=n(248),$t=n(42),Kt=n(118),qt=n(138),Yt=i.forwardRef((function(e,t){var n=e.value,r=e.setValue,a=e.className,c=e.offset,o=void 0===c?5:c,u=Object($t.a)(e,["value","setValue","className","offset"]),l=i.useRef(null),s=t,d=function(){var e=l.current,t=s.current;if(e&&t){window.swap=function(){e.style.display=window.swapped?"none":"block",t.style.display=window.swapped?"block":"none",window.swapped=!window.swapped},e.innerHTML=s.current.value+'<br style="line-height: 3px;">';var n;e.style.visibility="hidden",e.style.display="block",t.style.display="none",n=e.offsetHeight,e.style.visibility="visible",e.style.display="none",t.style.display="block",t.style.height=n+o+"px"}};return window.resize=d,i.useEffect(d,[n,s]),Object(j.s)(window,"resize",d),i.createElement(i.Fragment,null,i.createElement("div",{ref:l,className:"autoresize-div "+(a||""),style:{padding:2}}),i.createElement("textarea",Object.assign({},u,{onChange:function(e){return r(e.target.value)},value:n,className:"custom-textarea autoresize "+(a||""),ref:s})))})),Xt=function(e){var t=e.value,n=e.setValue,r=e.addNote,a=e.className,c=Object($t.a)(e,["value","setValue","addNote","className"]),o=i.useRef(null),u=Object(d.d)(Ut.boards.cards);return i.useEffect((function(){var e=new qt.TextareaEditor(o.current),t={context:function(e){return e.indexOf("[[")>=0},match:/\[\[([A-Za-z0-9_ -]+)$/,search:function(e,t){return t([].concat(Object(f.a)(Object(j.o)(e,u)),[0]))},cache:!0,template:function(e){return 0===e?r?"<em>Add note</em>":"":Object(j.i)(u[e])},replace:function(e){if(0===e&&r){var t=Object(j.h)();return window.setTimeout((function(){return r(t)}),0),"[[".concat(t,"]]")}return"[[".concat(e,"]]")}},n=new Kt.Textcomplete(e,[t],{dropdown:{rotate:!0,maxCount:10}});return function(){n.destroy(),delete window.__addNote}}),[]),i.createElement(Yt,Object.assign({},c,{ref:o,value:t,setValue:n,className:a}))},Qt=function(e){var t=e.card,n=e.setCard,r=i.useState(!1),a=Object(s.a)(r,2),c=a[0],o=a[1],u=Object(d.d)(Ut.boards.cards);if(!c&&"string"!==typeof t.description)return i.createElement(yn,{onClick:function(){return o(!0)}},"Add description");var l=function(e){c?27===e.which&&(o(!1),e.stopPropagation()):document.activeElement===e.target&&-1!==[32,13].indexOf(e.which)&&setTimeout((function(){return o(!0)}),0)};return c?i.createElement(i.Fragment,null,i.createElement(Ht.a,{className:"custom-label"},"Description"),i.createElement(Jt.a,{onClickAway:function(){return o(!1)}},i.createElement("div",{onKeyDown:l},i.createElement(Xt,{value:t.description,setValue:function(e){return n(Object(b.a)(Object(b.a)({},t),{},{description:e.length?e:void 0}))},className:"descriptionEditor",offset:20,autoFocus:!0})))):i.createElement("div",{style:{marginTop:8,overflow:"auto"}},i.createElement(Ht.a,{className:"custom-label",onClick:function(){return o(!0)}},"Description"),i.createElement(Vt,{source:t.description,cards:u,tabIndex:"0",onKeyDown:l,className:"markdown-selectable compact",onDoubleClick:function(){return o(!0)}}))},en=function(e){var t=e.card;if(t.description){var n=Object(j.d)(t);return i.createElement(En,{label:null,title:n,icon:i.createElement(Tt.a,null)})}return null},tn=n(139),nn=n.n(tn),rn=n(26),an=n(259),cn=n(148),on=n(254),un=n(149),ln=n(272),sn=n(104),dn=n.n(sn);ln.a.weekStart=1;var mn=function(e){var t=e.card,n=e.setCard,r=function(e){return n(Object(b.a)(Object(b.a)({},t),{},{time:e}))};return t.time?i.createElement("div",{style:{marginTop:10}},i.createElement(Ht.a,{className:"custom-label"},"Date & time"),i.createElement(rn.a,{utils:cn.a,locale:ln.a},i.createElement(an.a,{value:new Date(t.time),onChange:function(e){return r(e.getTime())},showTodayButton:!0,format:"MMMM do hh:mm aaa"})),i.createElement(ht.a,{size:"small",style:{marginLeft:10},onClick:function(){return r(null)}},i.createElement(dn.a,null))):i.createElement(yn,{onClick:function(){return r(Object(on.a)().getTime())}},"Add date & time")},fn=function(e){var t=e.card;return t.time?i.createElement(En,{icon:i.createElement(nn.a,null),label:Object(j.n)(t.time),title:Object(un.a)(new Date(t.time),"dd/MM/yyyy hh:mmaaa"),className:Object(j.r)(new Date(t.time).getTime())}):null},bn=n(140),pn=n.n(bn),hn=function(e){var t=e.card,n=e.setCard,r=i.useState(t.duration?vn(t.duration):""),a=Object(s.a)(r,2),c=a[0],o=a[1],u=i.useRef(null),l=function(e){var r=gn(e);o(e),"number"===typeof r&&n(Object(b.a)(Object(b.a)({},t),{},{duration:r}))};if(!t.duration)return i.createElement(yn,{onClick:function(){l("1h"),setTimeout((function(){try{u.current.focus()}catch(lr){}}),0)}},"Add duration");var d=function(e){return""!==e&&null!==e&&null===gn(e)};return i.createElement("div",{style:{marginTop:10}},i.createElement(Ht.a,{className:"custom-label"},"Duration"),i.createElement(Lt.a,{style:{width:201,marginTop:4},ref:u,margin:"dense",fullWidth:!0,value:c,error:d(c),helperText:d(c)?"Invalid format. Examples: 2d 1h 30m, 5m":null,onChange:function(e){return l(e.target.value)}}),i.createElement(ht.a,{size:"small",style:{marginLeft:10},onClick:function(){return n(Object(b.a)(Object(b.a)({},t),{},{duration:null}))}},i.createElement(dn.a,null)))},vn=function(e){if("string"===typeof e)return e;var t=Math.floor(e/86400),n=Math.floor(e%86400/3600),r=Math.floor(e%3600/60);return 0===t&&0===n&&0===r?"0m":((t?t+"d ":"")+(n?n+"h ":"")+(r?r+"m":"")).trim()},gn=function(e){if("number"===typeof e)return e;var t=/^(\d+d|\d*\.\d+d)?\s*(\d+h|\d*\.\d+h)?\s*(\d+m|\d*\.\d+m)?$/m.exec(e);if(!t||4!==t.length||!t.slice(1).filter((function(e){return e})).length)return null;var n=function(e){return parseFloat(e.substring(0,e.length-1))};return 86400*n((t=t.slice(1))[0]||"0d")+3600*n(t[1]||"0h")+60*n(t[2]||"0m")},On=function(e){var t=e.card;if(t.duration){var n=vn(t.duration),r="Duration: ".concat(n),a=i.createElement(pn.a,null);return i.createElement(En,{label:n,title:r,icon:a})}return null},En=function(e){var t=e.icon,n=e.label,r=e.title,a=e.className;return i.createElement(Zt.a,{size:"small",icon:t,label:n,title:r,classes:n&&n.length?null:{label:"attribute-label"},className:"attribute-indicator "+(a||""),variant:"outlined"})},yn=function(e){return i.createElement("div",{className:"attribute-header"},i.createElement(At.a,Object.assign({variant:"outlined",color:"primary",size:"small"},e)))},jn=function(e){var t=e.open,n=e.respond,r=e.title,a=e.subtitle,c=e.labels,o=void 0===c?["Cancel","OK"]:c;return i.createElement(St.a,{open:t,onClose:function(){return n(null)}},i.createElement(_t.a,null,r),i.createElement(Dt.a,null,i.createElement(Nt.a,null,a)),i.createElement(It.a,null,i.createElement(At.a,{onClick:function(){return n(!1)},color:"primary"},o[0]),i.createElement(At.a,{onClick:function(){return n(!0)},color:"primary",variant:"contained",autoFocus:!0},o[1])))},wn=function(e){var t=e.open,n=e.respond,r=e.title,a=e.subtitle,c=e.labels,o=void 0===c?["Cancel","OK"]:c,u=e.label,l=e.inputType,d=void 0===l?"text":l,m=e.placeholder,f=void 0===m?"":m,b=e.buttons,p=void 0===b?null:b,h=i.useState(f),v=Object(s.a)(h,2),g=v[0],O=v[1],E=function(e){n(e),O(f)};return i.createElement(St.a,{open:t,onClose:function(){return E(null)}},i.createElement(_t.a,null,r),i.createElement(Dt.a,null,"string"===typeof a&&i.createElement(Nt.a,null,a),i.createElement(Lt.a,{autoFocus:!0,margin:"dense",fullWidth:!0,label:u,type:d,value:g,onChange:function(e){return O(e.target.value)}})),i.createElement(It.a,null,p,i.createElement(At.a,{onClick:function(){return E(!1)},color:"primary"},o[0]),i.createElement(At.a,{onClick:function(){return E(g)},color:"primary",variant:"contained"},o[1])))},xn=function(e){var t=e.respond,n=e.card,o=Object(d.c)(),u=Object(d.d)((function(e){return Object.values(Pt(e).columns).filter((function(e){return-1!==e.items.indexOf(n.id)}))[0].id})),l=i.useState(u),m=Object(s.a)(l,2),p=m[0],h=m[1],v=i.useState(n),g=Object(s.a)(v,2),O=g[0],E=g[1],y=function(e){return E(Object(b.a)(Object(b.a)({},O),{},{content:e}))},w=Object(d.d)(Ut.boards.columns),x=Object(d.d)(Ut.boards.tabs),k=function(){t(),y(n.content)};return i.createElement(St.a,{open:!0,onClose:function(){return k()},fullWidth:!0,maxWidth:"md",disableBackdropClick:JSON.stringify(O)!==JSON.stringify(n)},i.createElement(j.c,{shouldProtect:JSON.stringify(O)!==JSON.stringify(n)}),i.createElement(_t.a,null,"Edit card"),i.createElement(Dt.a,null,i.createElement(Ht.a,{id:"kanban/card-column",className:"custom-label"},"Column"),i.createElement(Rt.a,{labelId:"kanban/card-column",value:p,onChange:function(e){return h(e.target.value)}},Object.values(x).flatMap((function(e){return[i.createElement(Mt.a,{key:e.id},e.name)].concat(Object(f.a)(e.columns.map((function(e){return i.createElement(Et.a,{value:e,key:e},w[e].name)}))))}))),i.createElement(Ht.a,{id:"kanban/card-title",className:"custom-label"},"Title"),i.createElement(Lt.a,{margin:"dense",autoFocus:!0,fullWidth:!0,multiline:!0,rowsMax:3,value:O.content,onChange:function(e){return y(e.target.value)}}),i.createElement(r.Edit,{card:O,setCard:E}),i.createElement(a.Edit,{card:O,setCard:E}),i.createElement(c.Edit,{card:O,setCard:E})),i.createElement(It.a,null,i.createElement(At.a,{onClick:function(){o(Ve({card:O,colID:p})),o(Je(n.id)),k()}},"Delete"),i.createElement(At.a,{onClick:k,color:"primary"},"Cancel"),i.createElement(At.a,{onClick:function(){o(Ve({card:O,colID:p})),k()},color:"primary",variant:"contained"},"OK")))},kn=function(e){var t=e.open,n=e.respond;return i.createElement(St.a,{open:t,onClose:n,fullWidth:!0},i.createElement(_t.a,null,"About Mirror"),i.createElement(Dt.a,null,i.createElement(Nt.a,null,"A free and open source personal task management and note taking app.",i.createElement("br",null),"Made by Oliver Balfour. \xa9 2020-2021.",i.createElement("br",null),"App icon is ",i.createElement("a",{href:"https://thenounproject.com/term/mirror/340140/"},"Mirror"),"\xa0 by Lastspark from ",i.createElement("a",{href:"http://thenounproject.com/"},"The Noun Project"),".")),i.createElement(It.a,null,i.createElement(At.a,{onClick:n,color:"primary",variant:"contained",autoFocus:!0},"OK")))},Cn=function(e){var t=e.open,n=e.respond,r=i.useState(""),a=Object(s.a)(r,2),c=a[0],o=a[1],u=i.useState(""),l=Object(s.a)(u,2),d=l[0],m=l[1],f=i.useState(""),b=Object(s.a)(f,2),p=b[0],h=b[1];return i.createElement(St.a,{open:t,onClose:n,fullWidth:!0},i.createElement(_t.a,null,"Log in via GitHub"),i.createElement(Dt.a,null,i.createElement(Nt.a,null,i.createElement(Ft.a,{source:'To log in via GitHub for synchronisation,\n            [create a new token](https://github.com/settings/tokens/new) with\n            the `gist` permission and save it somewhere safe. Then, go to\n            [gist.github.com](https://gist.github.com) and create a new Gist\n            with any title and add one file, `main.md`, with any contents.\n            Then click "Create secret gist" and copy the gist ID from the URL.\n            Enter your token, gist ID and username below.'})),i.createElement(Ht.a,{className:"custom-label"},"GitHub Username"),i.createElement(Lt.a,{margin:"dense",fullWidth:!0,value:p,onChange:function(e){return h(e.target.value)},autoComplete:"username"}),i.createElement(Ht.a,{className:"custom-label"},"Gist ID"),i.createElement(Lt.a,{margin:"dense",fullWidth:!0,value:d,onChange:function(e){return m(e.target.value)},autoComplete:"off"}),i.createElement(Ht.a,{className:"custom-label"},"GitHub access token"),i.createElement(Lt.a,{margin:"dense",autoFocus:!0,fullWidth:!0,value:c,onChange:function(e){return o(e.target.value)},type:"password",autoComplete:"current-password"})),i.createElement(It.a,null,i.createElement(At.a,{onClick:function(){return n(!1)},color:"primary"},"Cancel"),i.createElement(At.a,{onClick:function(){return n(c,d,p)},color:"primary",variant:"contained"},"Log in")))},Tn=function(e){var t=e.active,n=e.setActive,r=o.a.useState(!1),a=Object(s.a)(r,2),c=a[0],i=a[1],u=o.a.useState(!1),l=Object(s.a)(u,2),m=l[0],f=l[1],p=Object(d.c)(),h=Object(b.a)(Object(b.a)({"Submit feedback":function(){return window.open("mailto:".concat("leolalor1+mirrorsupport@googlemail.com"),"_blank")},About:function(){return i(!0)}},P()?{"Log out of GitHub":ge,"Force push to GitHub":Y,"Force pull from GitHub":X}:{"Log in via GitHub":function(){return f(!0)}}),{},{"Clear saved state":function(){return"YES"===window.prompt("Delete all saved state? Pressing undo will fix this. Type YES to confirm","NO")&&window.deleteAllState()}});return o.a.createElement(o.a.Fragment,null,o.a.createElement(ft.a,{color:"primary",className:"menubar"},o.a.createElement(wt.a,{style:{minHeight:0}},o.a.createElement(bt.a,{value:t,onChange:function(e,t){return n(t)},TabIndicatorProps:{style:{backgroundColor:"white"}}},o.a.createElement(pt.a,{label:o.a.createElement("div",null,o.a.createElement(kt.a,{style:{verticalAlign:"middle"}})," Boards")}),o.a.createElement(pt.a,{label:o.a.createElement("div",null,o.a.createElement(Tt.a,{style:{verticalAlign:"middle"}})," Notes")})),o.a.createElement("div",{style:{flexGrow:1}}),o.a.createElement(In,null),o.a.createElement(yt,{map:h},o.a.createElement(ht.a,{edge:"end",color:"inherit"},o.a.createElement(gt.a,null))))),o.a.createElement(kn,{open:c,respond:function(){return i(!1)}}),o.a.createElement(Cn,{open:m,respond:function(e,t,n){f(!1),!1!==e&&(G.token=e,G.gist_id=t,G.username=n,function(){return q.apply(this,arguments)}().then((function(e){return p(Pe(e))})))}}))},Sn=n(142),_n=n.n(Sn),Dn=n(143),Nn=n.n(Dn),In=function(){var e=Object(d.c)();return i.createElement(i.Fragment,null,i.createElement(ht.a,{onClick:function(){return e(O.ActionCreators.undo())},color:"inherit",edge:"end"},i.createElement(_n.a,null)),i.createElement(ht.a,{onClick:function(){return e(O.ActionCreators.redo())},color:"inherit",edge:"end"},i.createElement(Nn.a,null)))},An=function(e){return o.a.createElement("div",{className:"loading-screen-container"},o.a.createElement("span",{className:"loading-screen-contents"},"Loading..."))},Ln=n(60),Hn=n(258),Rn=n(70),Mn=n.n(Rn),zn=n(105),Bn=n.n(zn),Gn=function(e){var t=e.col,n=e.add,r=Object(d.c)(),a=i.useState(!1),c=Object(s.a)(a,2),o=c[0],u=c[1],l=i.useState(!1),m=Object(s.a)(l,2),f=m[0],p=m[1],h=t.items.filter((function(e){return-1!==["string","number"].indexOf(typeof e.time)})).length>0;return i.createElement("div",null,i.createElement("div",{className:"columnHeaderContainer"},i.createElement("div",{className:"columnHeaderText"},t.name),i.createElement("div",null,i.createElement(ht.a,{size:"small",onClick:function(){return n()}},i.createElement(Mn.a,null)),i.createElement(yt,{map:Object(b.a)(Object(b.a)({"Archive all":function(){return r(Xe(t.id))}},h?{"Sort by due":function(){return r(Qe(t.id))}}:{}),{},{Rename:function(){return p(!0)},Delete:function(){return u(!0)}})},i.createElement(ht.a,{size:"small"},i.createElement(gt.a,null))))),i.createElement("hr",{className:"columnHeaderRule"}),o&&i.createElement(jn,{open:!0,respond:function(e){u(!1),e&&r(Ke(t.id))},title:"Delete this column?",subtitle:"Don't worry, this action can be undone."}),f&&i.createElement(wn,{open:!0,respond:function(e){p(!1),"string"===typeof e&&e.length&&r(qe({colID:t.id,name:e}))},title:'Rename column "'.concat(t.name,'"'),subtitle:"Don't worry, this action can be undone.",label:"Name",placeholder:t.name}))},Pn=i.memo((function(e){var t=e.card,n=e.index,o=e.setEditingCard,u=Object(d.d)(Ut.boards.cards);if(!t)return null;var l=t.id,s=t.content;return i.createElement(i.Fragment,null,i.createElement(Ln.b,{draggableId:l,index:n},(function(e,n){return i.createElement("div",Object.assign({ref:e.innerRef},e.draggableProps,e.dragHandleProps,{className:"card "+(n.isDragging?" draggingCard":""),style:e.draggableProps.style,onClick:function(){return o(l)}}),i.createElement(Vt,{source:s,cards:u,className:"compact"}),i.createElement(r.Indicator,{card:t}),i.createElement(a.Indicator,{card:t}),i.createElement(c.Indicator,{card:t}))})))})),Un=i.memo((function(e){var t=e.col,n=e.index,r=e.setEditingCard,a=t.id,c=t.items,o=i.useState(!1),u=Object(s.a)(o,2),l=u[0],m=u[1],f=i.useState(""),b=Object(s.a)(f,2),p=b[0],h=b[1],v=Object(d.c)(),g=function(){p.length&&v(Fe({content:p,colID:a})),h(""),m(!1)},O=function(){l?h(""):E.current.scrollTop=0,m(!l)},E=i.useRef(null),y=i.createElement(Ln.c,{droppableId:a,className:"card-droppable",type:"card",ignoreContainerClipping:!0},(function(e,t){return i.createElement(i.Fragment,null,i.createElement("div",{className:"column-internals"+(t.isDraggingOver?" dragging-over":""),ref:Object(j.j)(e.innerRef,E)},l&&i.createElement(Zn,{value:p,setValue:h,add:g,cancel:function(){h(""),m(!1)}}),c.map((function(e,t){return e?i.createElement(Pn,{card:e,index:t,key:e.id,setEditingCard:r}):null}))),e.placeholder)}));return i.createElement(Ln.b,{draggableId:a,index:n},(function(e,n){return i.createElement("div",Object.assign({ref:e.innerRef},e.draggableProps,{className:"columnContainer"+(n.isDragging?" draggingColumn":""),style:e.draggableProps.style}),i.createElement("div",{className:"column"},i.createElement("div",e.dragHandleProps,i.createElement(Gn,{col:t,add:O})),i.createElement("div",{className:"column-internals-container"},y)))}))})),Zn=function(e){var t=e.value,n=e.setValue,r=e.add,a=e.cancel;return i.useEffect((function(){var e=function(e){return 27===e.which&&a()};return document.addEventListener("keydown",e),function(){return document.removeEventListener("keydown",e)}})),i.createElement("div",null,i.createElement(Lt.a,{label:"New card",multiline:!0,autoFocus:!0,rowsMax:6,value:t,onChange:function(e){return n(e.target.value)},variant:"filled",style:{width:"100%"}}),i.createElement(Hn.a,{variant:"contained",size:"small",className:"editingCardButtons"},i.createElement(At.a,{style:{flexGrow:1},variant:"contained",onClick:r},"Done"),i.createElement(At.a,{onClick:a},i.createElement(Bn.a,{style:{color:"#555"}}))))},Fn=function(e){var t=e.add,n=e.hide;return i.createElement("div",{className:"addColumnContainer columnContainer "+(n?" hidden":"")},i.createElement("div",{className:"addColumn column"},i.createElement(ht.a,{onClick:t,variant:"outlined"},i.createElement(Mn.a,null))))},Wn=(n(202),function(e){var t=e.tabInfo,n=e.addColumn,r=t.index,a=t.tab,c=Object(d.c)(),o=Object(d.d)(Ut.boards.tabOrder),u=Object(d.d)(Ut.boards.getColumnsInTabs)[o[r]],l=Object(d.d)(Ut.boards.tabs),m=Object(d.d)(Ut.boards.cards),f=l[o[r]].columns,b=i.useState(!1),p=Object(s.a)(b,2),h=p[0],v=p[1],g=Object(j.t)(),O=Object(s.a)(g,2),E=O[0],y=O[1],w="edit"===E.split("/")[4]?E.split("/")[3]:null,x=Object(d.d)(Ut.boards.cardsByTab),k=function(e){return y(e?"/boards/".concat(l[function(e){return Object.keys(x).filter((function(t){return-1!==x[t].indexOf(e)}))}(e)].name.toLowerCase(),"/").concat(e,"/edit"):"/boards/".concat(E.split("/")[2]))};return i.createElement("div",{className:"boardview-root"},i.createElement(Ln.a,{onDragEnd:function(e){e.destination&&("card"===e.type?c(function(e){var t=Object(s.a)(e,4),n=t[0],r=t[1],a=t[2],c=t[3];return n===r?Ze({colID:n,srcIndex:a,dstIndex:c}):Ue({srcColID:n,dstColID:r,srcIndex:a,dstIndex:c})}([e.source.droppableId,e.destination.droppableId,e.source.index,e.destination.index])):"column"===e.type&&c(Ye([e.source.index,e.destination.index,r])))}},i.createElement(Ln.c,{droppableId:"default",className:"column-droppable",direction:"horizontal",type:"column"},(function(e,t){return i.createElement(i.Fragment,null,i.createElement("div",{className:"root",ref:e.innerRef},f.map((function(e,t){return i.createElement(Un,{col:u[t],key:e,index:t,setEditingCard:k})})),n&&i.createElement(Fn,{add:function(){return v(!0)},hide:t.isDraggingOver||t.draggingFromThisWith})),e.placeholder)}))),h&&i.createElement(wn,{open:!0,respond:function(e){v(!1),"string"===typeof e&&e.length&&c($e({tabID:a.id,name:e}))},title:"Add column",label:"Name"}),w&&Object.prototype.hasOwnProperty.call(m,w)&&i.createElement(xn,{respond:function(){return k(null)},card:m[w]}))}),Vn=function(e){var t=e.active,n=Object(d.c)(),r=Object(j.t)(),a=Object(s.a)(r,2),c=a[0],o=a[1],u=Object(d.d)(Ut.boards.tabs),l=Object(d.d)(Ut.boards.tabOrder),m=l.map((function(e){return u[e].name.toLowerCase()===c.split("/")[2]})).indexOf(!0),f=function(e){return o("/boards/"+u[l[e]].name.toLowerCase())};Object(j.v)((function(){return t&&m>=0&&u[l[m]].name+" | Mirror"})),m<0&&(m=0);var b=i.useState(!localStorage.noAddColumn),p=Object(s.a)(b,2),h=p[0],v=p[1],g=i.useState(!1),O=Object(s.a)(g,2),E=O[0],y=O[1],w=i.useState(!1),x=Object(s.a)(w,2),k=x[0],C=x[1],T=i.useState(!1),S=Object(s.a)(T,2),_=S[0],D=S[1];return i.createElement(i.Fragment,null,i.createElement(jt,{tabs:l.map((function(e){return u[e].name})),render:function(e){return i.createElement(Wn,{key:e,tabInfo:{tab:u[l[e]],index:e},addColumn:h})},addTab:function(){return C(!0)},renameTab:function(){return D(!0)},deleteTab:function(){return Object.values(u).length>1?y(!0):alert("Cannot delete only tab")},moveTab:function(e){return n(rt(e))},index:m,setIndex:f,toggleAddColumn:function(){return e=!h,localStorage.noAddColumn=!e,void v(e);var e}}),E&&i.createElement(jn,{open:!0,respond:function(e){y(!1),e&&(n(tt(m)),f(Math.max(0,m-1)))},title:"Delete this tab?",subtitle:"Don't worry, this action can be undone."}),k&&i.createElement(wn,{open:!0,respond:function(e){C(!1),"string"===typeof e&&e.length&&n(et(e))},title:"Add tab",label:"Name"}),_&&i.createElement(wn,{open:!0,respond:function(e){D(!1),"string"===typeof e&&e.length&&n(nt({tabID:l[m],name:e}))},title:"Rename tab ".concat(u[l[m]].name),label:"Name"}))},Jn=n(144),$n=n.n(Jn),Kn=n(145),qn=n.n(Kn),Yn=n(147),Xn=n.n(Yn),Qn=n(146),er=n.n(Qn),tr=(n(203),function(e){var t=e.active,n=Object(j.t)(),r=Object(s.a)(n,1)[0],a=Object(d.c)(),c=Object(d.d)(Ut.boards.cards),o=Object(d.d)(Ut.boards.loadingZettel),u=r.split("/")[2]||"main";return Object.prototype.hasOwnProperty.call(c,u)?!0===o?i.createElement(nr,null):o===u?i.createElement(rr,{id:u}):i.createElement(ar,{active:t,dispatch:a,cards:c,currentCardID:u}):(a(ut(u)),i.createElement(nr,null))});function nr(){return i.createElement("span",null,"Loading Zettel...")}function rr(){return i.createElement("span",null,"Failed to load Zettel. Either synchronisation failed or it does not exist.")}function ar(e){var t=e.active,n=e.dispatch,r=e.cards,a=e.currentCardID,c=Object(j.t)(),o=Object(s.a)(c,2),u=o[0],l=o[1],m=Object(d.d)(Ut.boards.starredZettels),f=r[a],p=i.useState(Object(b.a)({},f)),h=Object(s.a)(p,2),v=h[0],g=h[1];Object(j.v)((function(){return t&&v.content+" | Mirror"}));var O=function(e){return g(Object(b.a)(Object(b.a)({},v),e))};if("object"!==typeof f)return null;var E="edit"===u.split("/")[3],y=function(e){return l(e?"/notes/".concat(a,"/edit"):"/notes/".concat(a))},w=function(){n(Je(a)),l("/notes/main")},x=function(){return n(ot(a))};f.id!==v.id&&(n(ct({zettel:v})),g(Object(b.a)({},f)));var k=function(e){n(at({zettel:{content:"New note",description:"...",id:e}})),l("/notes/".concat(e,"/edit"))},C=function(){return i.createElement(Hn.a,{variant:"contained",color:"primary"},!E&&i.createElement(At.a,{onClick:function(){return y(!0)},title:"Edit note"},i.createElement($n.a,null)),"main"!==f.id&&i.createElement(At.a,{onClick:w,title:"Delete note"},i.createElement(Bn.a,null)),!E&&i.createElement(At.a,{onClick:function(){return k(Object(j.h)())},title:"Add note"},i.createElement(Mn.a,null)),i.createElement(At.a,{onClick:function(){return alert("TODO")},title:"Search notes"},i.createElement(qn.a,null)),-1===m.indexOf(f.id)?i.createElement(At.a,{onClick:x,title:"Star this note"},i.createElement(er.a,null)):i.createElement(At.a,{onClick:x,title:"Unstar this note"},i.createElement(Xn.a,null)))};return i.createElement(i.Fragment,null,i.createElement(j.c,{shouldProtect:JSON.stringify(v)!==JSON.stringify(f)}),i.createElement("div",{className:"zettelContainer"},i.createElement("div",{className:"zettelButtons",id:"zettel-buttons-container"},i.createElement(C,null)),i.createElement("div",{className:"zettelColumns"},E&&i.createElement("div",{className:"zettel"+(E?" editing-pane":"")},i.createElement(Lt.a,{margin:"dense",autoFocus:!0,fullWidth:!0,className:"zettelEditingTitle",multiline:!0,rowsMax:3,value:v.content||"",onChange:function(e){return O({content:e.target.value})}}),i.createElement("div",{className:"zettelEditingContent"},i.createElement(Xt,{value:v.description||"",setValue:function(e){return O({description:e})},addNote:function(e){n(ct({zettel:v})),k(e)},className:"zettelEditingInput"})),i.createElement("div",{className:"zettelEditingButtons"},i.createElement(At.a,{onClick:function(){y(!1),g(Object(b.a)({},f))},color:"primary"},"Cancel"),i.createElement(At.a,{onClick:function(){return n(ct({zettel:v})),void y(!1)},color:"primary",variant:"contained"},"Save"))),i.createElement("div",{className:"zettel"+(E?" currently-editing":"")},i.createElement("div",{className:"zettelTitle"},(E?v.content:f.content)||""),i.createElement(Vt,{source:(E?v.description:f.description)||"",cards:r})))))}var cr=["boards","notes"],ir=function(e){var t=e.active;e.setActive;return o.a.createElement(o.a.Fragment,null,o.a.createElement(j.a,{show:0===t,className:"app-section"},o.a.createElement(Vn,{active:0===t})),o.a.createElement(j.a,{show:1===t,className:"app-section"},o.a.createElement(tr,{active:1===t})))},or=function(){var e=Object(d.c)();Object(j.u)((function(){P()&&Q().then((function(t){return e(Pe(t))}))}),15e3);var t=Object(j.t)(),n=Object(s.a)(t,2),r=n[0],a=n[1],c=o.a.useState([]),i=Object(s.a)(c,2),u=i[0],l=i[1],m=o.a.useState(!0),f=Object(s.a)(m,2),b=f[0],p=f[1],h=Object(d.d)((function(e){return void 0===e.present||Pt(e).loading}));if(b&&!h&&(l(["/boards/","/notes/main"]),p(!1)),h)return o.a.createElement(An,null);var v=function(e,t,n){var r=u.slice(0);r[t]=e,l(r),n&&a(e)},g=function(e){return Math.max(cr.indexOf((n=0,(t=e).split("/").filter((function(e){return e.length}))[n<0?t.length+n:n])),0);var t,n}(r),O=function(e){e===g?v(["/boards/","/notes/main"][g],g,!0):(v(r,g),a(u[e]))};return o.a.createElement("div",{id:"jsx-root"},o.a.createElement(ir,{active:g,setActive:O}),o.a.createElement(Tn,{active:g,setActive:O}))},ur=function(){return o.a.createElement(d.a,{store:Gt},o.a.createElement(or,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));n(204);l.a.render(o.a.createElement(ur,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},90:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(42),a=n(0),c=n(127),i=n.n(c),o=n(10),u=a.lazy((function(){return n.e(4).then(n.bind(null,209))})),l=function(e){var t=e.source,n=e.postprocess,c=void 0===n?function(e){return e}:n,l=Object(r.a)(e,["source","postprocess"]);try{return-1!==t.indexOf("```")?a.createElement(a.Suspense,{fallback:a.createElement("span",null,"Loading...")},a.createElement(u,Object.assign({source:t,postprocess:c},l))):a.createElement(o.b,Object.assign({source:c(i()(t,{gfm:!0}))},l,{className:"markdown "+(l.className?l.className:"")}))}catch(s){return a.createElement("span",null,"Sorry, an error occurred.",a.createElement("br",null),"Try editing the note to ensure any LaTeX math equations and the Markdown syntax are valid.",a.createElement("br",null),"Error: ",s.toString())}}}},[[171,1,2]]]);
//# sourceMappingURL=main.b65978e9.chunk.js.map